<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PyHydroGeophysX.inversion package &mdash; PyHydroGeophysX Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="canonical" href="https://YOUR_GITHUB_USERNAME.github.io/PyHydroGeophysX/api/PyHydroGeophysX.inversion.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2389946f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyHydroGeophysX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyHydroGeophysX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PyHydroGeophysX.inversion package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/YOUR_GITHUB_USERNAME/PyHydroGeophysX/blob/main/docs/source/api/PyHydroGeophysX.inversion.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyhydrogeophysx-inversion-package">
<h1>PyHydroGeophysX.inversion package<a class="headerlink" href="#pyhydrogeophysx-inversion-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-PyHydroGeophysX.inversion.base">
<span id="pyhydrogeophysx-inversion-base-module"></span><h2>PyHydroGeophysX.inversion.base module<a class="headerlink" href="#module-PyHydroGeophysX.inversion.base" title="Permalink to this heading"></a></h2>
<p>Base classes for geophysical inversion frameworks.</p>
<p>This module defines:
- <cite>InversionResult</cite>: A base class to store and manage common results from an inversion process,</p>
<blockquote>
<div><p>including final model, predicted data, convergence history, and plotting utilities.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>TimeLapseInversionResult</cite>: A specialized version of <cite>InversionResult</cite> for time-lapse studies,
handling multiple models over time and providing time-slice plotting and animation.</p></li>
<li><p><cite>InversionBase</cite>: An abstract base class outlining the common structure and interface
for various geophysical inversion methods (e.g., ERT, SRT). It handles data, mesh,
and basic parameter management.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.base.</span></span><span class="sig-name descname"><span class="pre">InversionResult</span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class to store, save, load, and plot results from a geophysical inversion.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.final_model">
<span class="sig-name descname"><span class="pre">final_model</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.final_model" title="Permalink to this definition"></a></dt>
<dd><p>The final inverted model parameters (e.g., resistivity, velocity).
Typically a 1D array corresponding to mesh cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.predicted_data">
<span class="sig-name descname"><span class="pre">predicted_data</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.predicted_data" title="Permalink to this definition"></a></dt>
<dd><p>The data predicted by the forward model using the <cite>final_model</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.coverage">
<span class="sig-name descname"><span class="pre">coverage</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.coverage" title="Permalink to this definition"></a></dt>
<dd><p>Coverage or sensitivity values for the model parameters,
often derived from the Jacobian or resolution matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.mesh">
<span class="sig-name descname"><span class="pre">mesh</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.mesh" title="Permalink to this definition"></a></dt>
<dd><p>The PyGIMLi mesh object used in the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[pg.Mesh]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.iteration_models">
<span class="sig-name descname"><span class="pre">iteration_models</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.iteration_models" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the model parameters at each iteration of the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.iteration_data_errors">
<span class="sig-name descname"><span class="pre">iteration_data_errors</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.iteration_data_errors" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the data misfit (e.g., residuals) at each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.iteration_chi2">
<span class="sig-name descname"><span class="pre">iteration_chi2</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.iteration_chi2" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the chi-squared (χ²) value or a similar misfit metric
at each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.meta">
<span class="sig-name descname"><span class="pre">meta</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.meta" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary to store any additional metadata about the inversion run
(e.g., inversion parameters, timings, comments).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize an empty InversionResult container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the inversion results to a file using Python’s pickle format.
If a mesh is present, it is saved separately as a PyGIMLi binary mesh file (.bms).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The base path (including filename without extension) to save the results.
The main data will be saved as <cite>filename.pkl</cite> (or just <cite>filename</cite> if user includes .pkl).
The mesh will be saved as <cite>filename.bms</cite> or <cite>filename.pkl.bms</cite>.
It’s recommended to provide <cite>filename</cite> without <cite>.pkl</cite>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>IOError</strong> – If there’s an error during file writing.</p></li>
<li><p><strong>pickle.PicklingError</strong> – If an object cannot be pickled.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.load" title="Permalink to this definition"></a></dt>
<dd><p>Load inversion results from a file previously saved by the <cite>save</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The base path to the saved results file.
If saved as <cite>name.pkl</cite> and <cite>name.bms</cite>, provide <cite>name.pkl</cite> or <cite>name</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An instance of <cite>InversionResult</cite> (or a subclass if called on one)</dt><dd><p>populated with the loaded data.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult">InversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the main data file or associated mesh file (if referenced) is not found.</p></li>
<li><p><strong>IOError</strong> – If there’s an error during file reading.</p></li>
<li><p><strong>pickle.UnpicklingError</strong> – If the file cannot be unpickled.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.plot_model">
<span class="sig-name descname"><span class="pre">plot_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.plot_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.plot_model" title="Permalink to this definition"></a></dt>
<dd><p>Plot the final inverted model on its associated mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – A matplotlib Axes object to plot on.
If None, a new figure and axes are created. Defaults to None.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for visualizing model values.
Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – If provided, cells with coverage values below this threshold will be masked
(made transparent or semi-transparent) in the plot. Requires <cite>self.coverage</cite>
to be populated. Defaults to None (no masking).</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>pygimli.show</cite>
(e.g., cMin, cMax, orientation, logScale).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects of the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>self.final_model</cite> or <cite>self.mesh</cite> is None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionResult.plot_convergence">
<span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.plot_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionResult.plot_convergence" title="Permalink to this definition"></a></dt>
<dd><p>Plot the convergence curve (chi-squared misfit vs. iteration number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – A matplotlib Axes object to plot on.
If None, a new figure and axes are created. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>ax.plot</cite>
(e.g., color, marker, linestyle).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects of the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>self.iteration_chi2</cite> is empty (no convergence data).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.base.</span></span><span class="sig-name descname"><span class="pre">TimeLapseInversionResult</span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionResult</span></code></a></p>
<p>Specialized class to store and manage results from time-lapse inversions.
Inherits from <cite>InversionResult</cite> and adds attributes specific to time-lapse data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.final_models">
<span class="sig-name descname"><span class="pre">final_models</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.final_models" title="Permalink to this definition"></a></dt>
<dd><p>A 2D NumPy array where each column represents
the inverted model for a specific timestep
(shape: num_cells x num_timesteps).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.timesteps">
<span class="sig-name descname"><span class="pre">timesteps</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.timesteps" title="Permalink to this definition"></a></dt>
<dd><p>An array or list of time values (e.g., hours, days)
corresponding to each model slice in <cite>final_models</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.all_coverage">
<span class="sig-name descname"><span class="pre">all_coverage</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.all_coverage" title="Permalink to this definition"></a></dt>
<dd><p>A list where each element is the coverage array
for the corresponding timestep’s model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.all_chi2">
<span class="sig-name descname"><span class="pre">all_chi2</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.all_chi2" title="Permalink to this definition"></a></dt>
<dd><p>A list where each element is a list of chi-squared values
per iteration for the inversion of that specific timestep or window.
(Note: Original was List[float], if chi2 is per window, might need adjustment)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize an empty TimeLapseInversionResult container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.save" title="Permalink to this definition"></a></dt>
<dd><p>Save time-lapse inversion results. Overrides base class <cite>save</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.load" title="Permalink to this definition"></a></dt>
<dd><p>Load time-lapse inversion results. Overrides base class <cite>load</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.plot_time_slice">
<span class="sig-name descname"><span class="pre">plot_time_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.plot_time_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.plot_time_slice" title="Permalink to this definition"></a></dt>
<dd><p>Plot a single time slice (inverted model at a specific timestep) from the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestep_idx</strong> (<em>int</em>) – The zero-based index of the timestep to plot.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – Matplotlib Axes to plot on. If None, creates new.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for model values. Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Threshold for coverage masking.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to <cite>pg.show</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If models or mesh are missing, or if <cite>timestep_idx</cite> is out of range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.TimeLapseInversionResult.create_time_lapse_animation">
<span class="sig-name descname"><span class="pre">create_time_lapse_animation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.create_time_lapse_animation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.TimeLapseInversionResult.create_time_lapse_animation" title="Permalink to this definition"></a></dt>
<dd><p>Create and save an animation (e.g., MP4 video) of the time-lapse inversion results.</p>
<p>Requires <cite>ffmpeg</cite> or another Matplotlib-supported animation writer to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_filename</strong> (<em>str</em>) – The filename for the output animation (e.g., ‘timelapse_animation.mp4’).</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for model values. Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Threshold for coverage masking. Defaults to None.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Dots Per Inch for the output animation. Defaults to 100.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) – Frames Per Second for the animation. Defaults to 2.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed to <cite>plot_time_slice</cite> for each frame.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>final_models</cite> or <cite>mesh</cite> is missing.</p></li>
<li><p><strong>ImportError</strong> – If <cite>matplotlib.animation</cite> cannot be imported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.base.</span></span><span class="sig-name descname"><span class="pre">InversionBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2581478943120'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for geophysical inversion methods.</p>
<p>This class provides a foundational structure for specific inversion techniques
(e.g., ERT, SRT). It manages observed data, mesh, common inversion parameters,
and an <cite>InversionResult</cite> object. Subclasses must implement methods for
setting up the inversion, running the inversion loop, computing Jacobians,
and evaluating the objective function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2581478943120'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the base inversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pg.DataContainer</em>) – PyGIMLi DataContainer holding the observed geophysical data.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi mesh for the inversion.
If None, it’s expected that subclasses will create or
load a mesh in their <cite>setup</cite> method. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments for configuring the inversion.
These are stored in <cite>self.parameters</cite> and can override defaults.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase.setup" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to set up the inversion specifics.</p>
<p>This should be implemented by derived classes to prepare everything needed
for the inversion, such as:
- Creating or validating the mesh if not already done.
- Initializing forward modeling operators.
- Preparing data weighting and model regularization matrices.
- Setting up initial models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase.run" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to run the main inversion loop.</p>
<p>Derived classes must implement this to perform the iterative optimization process.
The method should populate and return an <cite>InversionResult</cite> (or subclass) object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An object containing the results of the inversion.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult">InversionResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase.compute_jacobian">
<span class="sig-name descname"><span class="pre">compute_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.compute_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase.compute_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to compute the Jacobian matrix (sensitivity matrix).</p>
<p>The Jacobian J_ij = ∂d_i / ∂m_j relates changes in model parameters (m_j)
to changes in observed data (d_i).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>np.ndarray</em>) – The current model parameter vector for which to compute the Jacobian.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns:,</dt><dd><p>np.ndarray: The computed Jacobian matrix, typically of shape (n_data, n_model_params).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.base.InversionBase.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_to_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.objective_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.base.InversionBase.objective_function" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to compute the value of the objective function.</p>
<p>The objective function typically includes a data misfit term and one or more
regularization terms: Φ(m) = Φ_d(m) + λ * Φ_m(m).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>np.ndarray</em>) – The current model parameter vector.</p></li>
<li><p><strong>data_to_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – The observed data to fit.
If None, <cite>self.data</cite> (from DataContainer)
is typically used. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated value of the objective function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyHydroGeophysX.inversion.ert_inversion">
<span id="pyhydrogeophysx-inversion-ert-inversion-module"></span><h2>PyHydroGeophysX.inversion.ert_inversion module<a class="headerlink" href="#module-PyHydroGeophysX.inversion.ert_inversion" title="Permalink to this heading"></a></h2>
<p>Single-time Electrical Resistivity Tomography (ERT) inversion functionality.</p>
<p>This module provides the <cite>ERTInversion</cite> class, which performs a standard
single-time ERT inversion using PyGIMLi. It handles data loading, mesh creation
(if not provided), forward modeling, Jacobian computation, and an iterative
Gauss-Newton like optimization scheme with regularization and model constraints.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ert_inversion.ERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.ert_inversion.</span></span><span class="sig-name descname"><span class="pre">ERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ert_inversion.ERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionBase" title="PyHydroGeophysX.inversion.base.InversionBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionBase</span></code></a></p>
<p>Performs a single-time Electrical Resistivity Tomography (ERT) inversion.</p>
<p>This class inherits from <cite>InversionBase</cite> and implements the specific steps
for ERT inversion, including setting up PyGIMLi’s ERT forward operator,
data weighting, model regularization, and an iterative inversion loop.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ert_inversion.ERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ert_inversion.ERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ERTInversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_file</strong> (<em>str</em>) – Path to the ERT data file (readable by <cite>pygimli.ert.load</cite>).</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh for the inversion.
If None, a mesh will be automatically created
based on the data during the <cite>setup()</cite> phase.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments to override default inversion parameters.
See <cite>InversionBase</cite> and ERT-specific defaults below. Common parameters include:
- <cite>lambda_val</cite> (float): Initial regularization parameter.
- <cite>method</cite> (str): Solver method for the linear system (e.g., ‘cgls’, ‘lsqr’).
- <cite>model_constraints</cite> (Tuple[float, float]): Min and max bounds for resistivity [ohm·m].
- <cite>max_iterations</cite> (int): Maximum number of inversion iterations.
- <cite>absoluteUError</cite> (float): Absolute error in voltage (U) for data error estimation [V].
- <cite>relativeError</cite> (float): Relative error percentage for data error estimation (e.g., 0.05 for 5%).
- <cite>lambda_rate</cite> (float): Factor to reduce lambda at each iteration if chi^2 improves.
- <cite>lambda_min</cite> (float): Minimum value for lambda.
- <cite>use_gpu</cite> (bool): Whether to attempt GPU acceleration (requires CuPy and compatible solver).
- <cite>parallel</cite> (bool): Whether to use parallel CPU computation for certain solver steps.
- <cite>n_jobs</cite> (int): Number of CPU jobs for parallel execution.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the <cite>data_file</cite> does not exist.</p></li>
<li><p><strong>Exception</strong> – If <cite>pygimli.ert.load</cite> fails to load the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ert_inversion.ERTInversion.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ert_inversion.ERTInversion.setup" title="Permalink to this definition"></a></dt>
<dd><p>Set up the ERT inversion environment.</p>
<p>This involves:
- Creating an inversion mesh if not already provided.
- Initializing the PyGIMLi <cite>ERTModelling</cite> forward operator.
- Preparing observed data (log-transforming apparent resistivities).
- Calculating data error weighting matrix (<cite>self.Wd</cite>).
- Creating the model regularization matrix (<cite>self.Wm_r</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ert_inversion.ERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_model_linear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ert_inversion.ERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the ERT inversion using an iterative Gauss-Newton like approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial_model_linear</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Initial guess for the resistivity model [ohm·m] (linear scale).
If None, a homogeneous model based on the median of observed apparent
resistivities is used. Should be a 1D array or a 2D column vector.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object containing all results of the inversion process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="PyHydroGeophysX.html#PyHydroGeophysX.InversionResult" title="PyHydroGeophysX.InversionResult">InversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>setup()</cite> has not been called successfully.</p></li>
<li><p><strong>ValueError</strong> – If initial model dimensions are incorrect.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ert_inversion.ERTInversion.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_for_coverage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_log_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ert_inversion.ERTInversion.get_coverage" title="Permalink to this definition"></a></dt>
<dd><p>Computes coverage (sensitivity/resolution proxy) for the current forward operator setup and a given model.
This method is similar to <cite>ERTForwardModeling.get_coverage</cite> but uses the instance’s attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_for_coverage</strong> (<em>np.ndarray</em>) – The model parameters (1D array, typically log-transformed resistivity
if <cite>is_log_model</cite> is True) for which to calculate coverage.</p></li>
<li><p><strong>is_log_model</strong> (<em>bool</em>) – If True, <cite>model_for_coverage</cite> is assumed to be log-transformed (natural log)
and will be exponentiated before use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An array of log10-transformed coverage values for each cell,</dt><dd><p>or None if calculation fails.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyHydroGeophysX.inversion.time_lapse">
<span id="pyhydrogeophysx-inversion-time-lapse-module"></span><h2>PyHydroGeophysX.inversion.time_lapse module<a class="headerlink" href="#module-PyHydroGeophysX.inversion.time_lapse" title="Permalink to this heading"></a></h2>
<p>Time-lapse Electrical Resistivity Tomography (ERT) inversion functionality.</p>
<p>This module provides the <cite>TimeLapseERTInversion</cite> class for performing
time-lapse ERT inversions. It builds upon the base inversion framework and
incorporates temporal regularization to link inversions across different
timesteps. Helper functions for Jacobian calculation and forward modeling
in a time-lapse context are also included.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.time_lapse.</span></span><span class="sig-name descname"><span class="pre">TimeLapseERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionBase" title="PyHydroGeophysX.inversion.base.InversionBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionBase</span></code></a></p>
<p>Performs time-lapse Electrical Resistivity Tomography (ERT) inversion.</p>
<p>This class extends <cite>InversionBase</cite> to handle multiple ERT datasets collected
over time. It incorporates temporal regularization to link the inversions of
consecutive timesteps, promoting smoother changes or enforcing specific
temporal behaviors in the resistivity models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the TimeLapseERTInversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_files</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of file paths, where each path points to an
ERT data file for a specific timestep.</p></li>
<li><p><strong>measurement_times</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – A list or NumPy array of time values
(e.g., hours, days) corresponding to each data file.
Must be the same length as <cite>data_files</cite>.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi mesh for the inversion. If None,
a mesh is created based on the first dataset
during <cite>setup()</cite>. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments for configuring the inversion.
These override defaults in <cite>InversionBase</cite> and time-lapse specific defaults.
Key time-lapse parameters include:
- <cite>alpha</cite> (float): Temporal regularization strength.
- <cite>decay_rate</cite> (float): Decay rate for temporal weights (exp(-decay*dt)).
- <cite>inversion_type</cite> (str): Norm for misfit (‘L1’, ‘L2’, ‘L1L2’).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>data_files</cite> is empty or if lengths of <cite>data_files</cite> and <cite>measurement_times</cite> mismatch.</p></li>
<li><p><strong>RuntimeError</strong> – If loading the first data file fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.setup" title="Permalink to this definition"></a></dt>
<dd><p>Set up the time-lapse ERT inversion environment.</p>
<p>This involves:
- Creating/validating the common inversion mesh.
- Loading all time-lapse datasets and their error models.
- Initializing a PyGIMLi <cite>ERTModelling</cite> forward operator for each dataset.
- Preparing observed data (stacking log-transformed apparent resistivities).
- Constructing combined data weighting matrix (<cite>self.Wd_stacked</cite>).
- Constructing combined spatial regularization matrix (<cite>self.Wm_stacked</cite>).
- Constructing temporal regularization matrix (<cite>self.Wt_temporal</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_model_linear_3d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.time_lapse.TimeLapseERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial_model_linear_3d</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Initial guess for the resistivity model [ohm·m] (linear scale).
Should be a 2D array of shape (num_cells, num_timesteps).
If None, a homogeneous model for each timestep is derived from the median
of its respective observed apparent resistivities. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object containing the results of the time-lapse inversion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="PyHydroGeophysX.html#PyHydroGeophysX.TimeLapseInversionResult" title="PyHydroGeophysX.TimeLapseInversionResult">TimeLapseInversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>setup()</cite> has not been called or if inversion encounters critical errors.</p></li>
<li><p><strong>ValueError</strong> – If <cite>initial_model_linear_3d</cite> has incorrect shape.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyHydroGeophysX.inversion.windowed">
<span id="pyhydrogeophysx-inversion-windowed-module"></span><h2>PyHydroGeophysX.inversion.windowed module<a class="headerlink" href="#module-PyHydroGeophysX.inversion.windowed" title="Permalink to this heading"></a></h2>
<p>Windowed time-lapse ERT inversion for handling large temporal datasets.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.windowed.</span></span><span class="sig-name descname"><span class="pre">WindowedTimeLapseERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_dir:</span> <span class="pre">str,</span> <span class="pre">ert_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float],</span> <span class="pre">window_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for windowed time-lapse ERT inversion to handle large temporal datasets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_dir:</span> <span class="pre">str,</span> <span class="pre">ert_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float],</span> <span class="pre">window_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize windowed time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> – Directory containing ERT data files</p></li>
<li><p><strong>ert_files</strong> – List of ERT data filenames</p></li>
<li><p><strong>measurement_times</strong> – List of measurement times</p></li>
<li><p><strong>window_size</strong> – Size of sliding window</p></li>
<li><p><strong>mesh</strong> – Mesh for inversion or path to mesh file</p></li>
<li><p><strong>**kwargs</strong> – Additional parameters to pass to TimeLapseERTInversion</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_parallel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_window_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.windowed.WindowedTimeLapseERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run windowed time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_parallel</strong> – Whether to process windows in parallel</p></li>
<li><p><strong>max_window_workers</strong> – Maximum number of parallel workers (None for auto)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TimeLapseInversionResult with stitched results</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-PyHydroGeophysX.inversion">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-PyHydroGeophysX.inversion" title="Permalink to this heading"></a></h2>
<p>Inversion framework for geophysical applications.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">InversionBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2581478943120'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for geophysical inversion methods.</p>
<p>This class provides a foundational structure for specific inversion techniques
(e.g., ERT, SRT). It manages observed data, mesh, common inversion parameters,
and an <cite>InversionResult</cite> object. Subclasses must implement methods for
setting up the inversion, running the inversion loop, computing Jacobians,
and evaluating the objective function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2581478943120'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the base inversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pg.DataContainer</em>) – PyGIMLi DataContainer holding the observed geophysical data.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi mesh for the inversion.
If None, it’s expected that subclasses will create or
load a mesh in their <cite>setup</cite> method. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments for configuring the inversion.
These are stored in <cite>self.parameters</cite> and can override defaults.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase.setup" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to set up the inversion specifics.</p>
<p>This should be implemented by derived classes to prepare everything needed
for the inversion, such as:
- Creating or validating the mesh if not already done.
- Initializing forward modeling operators.
- Preparing data weighting and model regularization matrices.
- Setting up initial models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase.run" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to run the main inversion loop.</p>
<p>Derived classes must implement this to perform the iterative optimization process.
The method should populate and return an <cite>InversionResult</cite> (or subclass) object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An object containing the results of the inversion.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.InversionResult" title="PyHydroGeophysX.inversion.InversionResult">InversionResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase.compute_jacobian">
<span class="sig-name descname"><span class="pre">compute_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.compute_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase.compute_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to compute the Jacobian matrix (sensitivity matrix).</p>
<p>The Jacobian J_ij = ∂d_i / ∂m_j relates changes in model parameters (m_j)
to changes in observed data (d_i).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>np.ndarray</em>) – The current model parameter vector for which to compute the Jacobian.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns:,</dt><dd><p>np.ndarray: The computed Jacobian matrix, typically of shape (n_data, n_model_params).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionBase.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_to_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionBase.objective_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionBase.objective_function" title="Permalink to this definition"></a></dt>
<dd><p>Abstract method to compute the value of the objective function.</p>
<p>The objective function typically includes a data misfit term and one or more
regularization terms: Φ(m) = Φ_d(m) + λ * Φ_m(m).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>np.ndarray</em>) – The current model parameter vector.</p></li>
<li><p><strong>data_to_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – The observed data to fit.
If None, <cite>self.data</cite> (from DataContainer)
is typically used. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated value of the objective function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">InversionResult</span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class to store, save, load, and plot results from a geophysical inversion.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.final_model">
<span class="sig-name descname"><span class="pre">final_model</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.final_model" title="Permalink to this definition"></a></dt>
<dd><p>The final inverted model parameters (e.g., resistivity, velocity).
Typically a 1D array corresponding to mesh cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.predicted_data">
<span class="sig-name descname"><span class="pre">predicted_data</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.predicted_data" title="Permalink to this definition"></a></dt>
<dd><p>The data predicted by the forward model using the <cite>final_model</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.coverage">
<span class="sig-name descname"><span class="pre">coverage</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.coverage" title="Permalink to this definition"></a></dt>
<dd><p>Coverage or sensitivity values for the model parameters,
often derived from the Jacobian or resolution matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.mesh">
<span class="sig-name descname"><span class="pre">mesh</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.mesh" title="Permalink to this definition"></a></dt>
<dd><p>The PyGIMLi mesh object used in the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[pg.Mesh]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.iteration_models">
<span class="sig-name descname"><span class="pre">iteration_models</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.iteration_models" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the model parameters at each iteration of the inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.iteration_data_errors">
<span class="sig-name descname"><span class="pre">iteration_data_errors</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.iteration_data_errors" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the data misfit (e.g., residuals) at each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.iteration_chi2">
<span class="sig-name descname"><span class="pre">iteration_chi2</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.iteration_chi2" title="Permalink to this definition"></a></dt>
<dd><p>A list storing the chi-squared (χ²) value or a similar misfit metric
at each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.meta">
<span class="sig-name descname"><span class="pre">meta</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.meta" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary to store any additional metadata about the inversion run
(e.g., inversion parameters, timings, comments).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize an empty InversionResult container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the inversion results to a file using Python’s pickle format.
If a mesh is present, it is saved separately as a PyGIMLi binary mesh file (.bms).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The base path (including filename without extension) to save the results.
The main data will be saved as <cite>filename.pkl</cite> (or just <cite>filename</cite> if user includes .pkl).
The mesh will be saved as <cite>filename.bms</cite> or <cite>filename.pkl.bms</cite>.
It’s recommended to provide <cite>filename</cite> without <cite>.pkl</cite>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>IOError</strong> – If there’s an error during file writing.</p></li>
<li><p><strong>pickle.PicklingError</strong> – If an object cannot be pickled.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.load" title="Permalink to this definition"></a></dt>
<dd><p>Load inversion results from a file previously saved by the <cite>save</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The base path to the saved results file.
If saved as <cite>name.pkl</cite> and <cite>name.bms</cite>, provide <cite>name.pkl</cite> or <cite>name</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An instance of <cite>InversionResult</cite> (or a subclass if called on one)</dt><dd><p>populated with the loaded data.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.InversionResult" title="PyHydroGeophysX.inversion.InversionResult">InversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the main data file or associated mesh file (if referenced) is not found.</p></li>
<li><p><strong>IOError</strong> – If there’s an error during file reading.</p></li>
<li><p><strong>pickle.UnpicklingError</strong> – If the file cannot be unpickled.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.plot_model">
<span class="sig-name descname"><span class="pre">plot_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.plot_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.plot_model" title="Permalink to this definition"></a></dt>
<dd><p>Plot the final inverted model on its associated mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – A matplotlib Axes object to plot on.
If None, a new figure and axes are created. Defaults to None.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for visualizing model values.
Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – If provided, cells with coverage values below this threshold will be masked
(made transparent or semi-transparent) in the plot. Requires <cite>self.coverage</cite>
to be populated. Defaults to None (no masking).</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>pygimli.show</cite>
(e.g., cMin, cMax, orientation, logScale).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects of the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>self.final_model</cite> or <cite>self.mesh</cite> is None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.InversionResult.plot_convergence">
<span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#InversionResult.plot_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.InversionResult.plot_convergence" title="Permalink to this definition"></a></dt>
<dd><p>Plot the convergence curve (chi-squared misfit vs. iteration number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – A matplotlib Axes object to plot on.
If None, a new figure and axes are created. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>ax.plot</cite>
(e.g., color, marker, linestyle).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects of the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>self.iteration_chi2</cite> is empty (no convergence data).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">TimeLapseInversionResult</span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionResult</span></code></a></p>
<p>Specialized class to store and manage results from time-lapse inversions.
Inherits from <cite>InversionResult</cite> and adds attributes specific to time-lapse data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.final_models">
<span class="sig-name descname"><span class="pre">final_models</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.final_models" title="Permalink to this definition"></a></dt>
<dd><p>A 2D NumPy array where each column represents
the inverted model for a specific timestep
(shape: num_cells x num_timesteps).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.timesteps">
<span class="sig-name descname"><span class="pre">timesteps</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.timesteps" title="Permalink to this definition"></a></dt>
<dd><p>An array or list of time values (e.g., hours, days)
corresponding to each model slice in <cite>final_models</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.all_coverage">
<span class="sig-name descname"><span class="pre">all_coverage</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.all_coverage" title="Permalink to this definition"></a></dt>
<dd><p>A list where each element is the coverage array
for the corresponding timestep’s model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.all_chi2">
<span class="sig-name descname"><span class="pre">all_chi2</span></span><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.all_chi2" title="Permalink to this definition"></a></dt>
<dd><p>A list where each element is a list of chi-squared values
per iteration for the inversion of that specific timestep or window.
(Note: Original was List[float], if chi2 is per window, might need adjustment)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize an empty TimeLapseInversionResult container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.save" title="Permalink to this definition"></a></dt>
<dd><p>Save time-lapse inversion results. Overrides base class <cite>save</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.load" title="Permalink to this definition"></a></dt>
<dd><p>Load time-lapse inversion results. Overrides base class <cite>load</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.plot_time_slice">
<span class="sig-name descname"><span class="pre">plot_time_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.plot_time_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.plot_time_slice" title="Permalink to this definition"></a></dt>
<dd><p>Plot a single time slice (inverted model at a specific timestep) from the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestep_idx</strong> (<em>int</em>) – The zero-based index of the timestep to plot.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – Matplotlib Axes to plot on. If None, creates new.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for model values. Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Threshold for coverage masking.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to <cite>pg.show</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Figure and Axes objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If models or mesh are missing, or if <cite>timestep_idx</cite> is out of range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseInversionResult.create_time_lapse_animation">
<span class="sig-name descname"><span class="pre">create_time_lapse_animation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/base.html#TimeLapseInversionResult.create_time_lapse_animation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseInversionResult.create_time_lapse_animation" title="Permalink to this definition"></a></dt>
<dd><p>Create and save an animation (e.g., MP4 video) of the time-lapse inversion results.</p>
<p>Requires <cite>ffmpeg</cite> or another Matplotlib-supported animation writer to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_filename</strong> (<em>str</em>) – The filename for the output animation (e.g., ‘timelapse_animation.mp4’).</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for model values. Defaults to ‘viridis’.</p></li>
<li><p><strong>coverage_threshold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Threshold for coverage masking. Defaults to None.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Dots Per Inch for the output animation. Defaults to 100.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) – Frames Per Second for the animation. Defaults to 2.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed to <cite>plot_time_slice</cite> for each frame.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>final_models</cite> or <cite>mesh</cite> is missing.</p></li>
<li><p><strong>ImportError</strong> – If <cite>matplotlib.animation</cite> cannot be imported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">ERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionBase" title="PyHydroGeophysX.inversion.base.InversionBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionBase</span></code></a></p>
<p>Performs a single-time Electrical Resistivity Tomography (ERT) inversion.</p>
<p>This class inherits from <cite>InversionBase</cite> and implements the specific steps
for ERT inversion, including setting up PyGIMLi’s ERT forward operator,
data weighting, model regularization, and an iterative inversion loop.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ERTInversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_file</strong> (<em>str</em>) – Path to the ERT data file (readable by <cite>pygimli.ert.load</cite>).</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh for the inversion.
If None, a mesh will be automatically created
based on the data during the <cite>setup()</cite> phase.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments to override default inversion parameters.
See <cite>InversionBase</cite> and ERT-specific defaults below. Common parameters include:
- <cite>lambda_val</cite> (float): Initial regularization parameter.
- <cite>method</cite> (str): Solver method for the linear system (e.g., ‘cgls’, ‘lsqr’).
- <cite>model_constraints</cite> (Tuple[float, float]): Min and max bounds for resistivity [ohm·m].
- <cite>max_iterations</cite> (int): Maximum number of inversion iterations.
- <cite>absoluteUError</cite> (float): Absolute error in voltage (U) for data error estimation [V].
- <cite>relativeError</cite> (float): Relative error percentage for data error estimation (e.g., 0.05 for 5%).
- <cite>lambda_rate</cite> (float): Factor to reduce lambda at each iteration if chi^2 improves.
- <cite>lambda_min</cite> (float): Minimum value for lambda.
- <cite>use_gpu</cite> (bool): Whether to attempt GPU acceleration (requires CuPy and compatible solver).
- <cite>parallel</cite> (bool): Whether to use parallel CPU computation for certain solver steps.
- <cite>n_jobs</cite> (int): Number of CPU jobs for parallel execution.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the <cite>data_file</cite> does not exist.</p></li>
<li><p><strong>Exception</strong> – If <cite>pygimli.ert.load</cite> fails to load the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ERTInversion.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ERTInversion.setup" title="Permalink to this definition"></a></dt>
<dd><p>Set up the ERT inversion environment.</p>
<p>This involves:
- Creating an inversion mesh if not already provided.
- Initializing the PyGIMLi <cite>ERTModelling</cite> forward operator.
- Preparing observed data (log-transforming apparent resistivities).
- Calculating data error weighting matrix (<cite>self.Wd</cite>).
- Creating the model regularization matrix (<cite>self.Wm_r</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_model_linear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionResult" title="PyHydroGeophysX.inversion.base.InversionResult"><span class="pre">InversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the ERT inversion using an iterative Gauss-Newton like approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial_model_linear</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Initial guess for the resistivity model [ohm·m] (linear scale).
If None, a homogeneous model based on the median of observed apparent
resistivities is used. Should be a 1D array or a 2D column vector.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object containing all results of the inversion process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.InversionResult" title="PyHydroGeophysX.inversion.InversionResult">InversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>setup()</cite> has not been called successfully.</p></li>
<li><p><strong>ValueError</strong> – If initial model dimensions are incorrect.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.ERTInversion.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_for_coverage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_log_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/ert_inversion.html#ERTInversion.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.ERTInversion.get_coverage" title="Permalink to this definition"></a></dt>
<dd><p>Computes coverage (sensitivity/resolution proxy) for the current forward operator setup and a given model.
This method is similar to <cite>ERTForwardModeling.get_coverage</cite> but uses the instance’s attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_for_coverage</strong> (<em>np.ndarray</em>) – The model parameters (1D array, typically log-transformed resistivity
if <cite>is_log_model</cite> is True) for which to calculate coverage.</p></li>
<li><p><strong>is_log_model</strong> (<em>bool</em>) – If True, <cite>model_for_coverage</cite> is assumed to be log-transformed (natural log)
and will be exponentiated before use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An array of log10-transformed coverage values for each cell,</dt><dd><p>or None if calculation fails.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">TimeLapseERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.InversionBase" title="PyHydroGeophysX.inversion.base.InversionBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">InversionBase</span></code></a></p>
<p>Performs time-lapse Electrical Resistivity Tomography (ERT) inversion.</p>
<p>This class extends <cite>InversionBase</cite> to handle multiple ERT datasets collected
over time. It incorporates temporal regularization to link the inversions of
consecutive timesteps, promoting smoother changes or enforcing specific
temporal behaviors in the resistivity models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the TimeLapseERTInversion class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_files</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of file paths, where each path points to an
ERT data file for a specific timestep.</p></li>
<li><p><strong>measurement_times</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – A list or NumPy array of time values
(e.g., hours, days) corresponding to each data file.
Must be the same length as <cite>data_files</cite>.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi mesh for the inversion. If None,
a mesh is created based on the first dataset
during <cite>setup()</cite>. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments for configuring the inversion.
These override defaults in <cite>InversionBase</cite> and time-lapse specific defaults.
Key time-lapse parameters include:
- <cite>alpha</cite> (float): Temporal regularization strength.
- <cite>decay_rate</cite> (float): Decay rate for temporal weights (exp(-decay*dt)).
- <cite>inversion_type</cite> (str): Norm for misfit (‘L1’, ‘L2’, ‘L1L2’).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>data_files</cite> is empty or if lengths of <cite>data_files</cite> and <cite>measurement_times</cite> mismatch.</p></li>
<li><p><strong>RuntimeError</strong> – If loading the first data file fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseERTInversion.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseERTInversion.setup" title="Permalink to this definition"></a></dt>
<dd><p>Set up the time-lapse ERT inversion environment.</p>
<p>This involves:
- Creating/validating the common inversion mesh.
- Loading all time-lapse datasets and their error models.
- Initializing a PyGIMLi <cite>ERTModelling</cite> forward operator for each dataset.
- Preparing observed data (stacking log-transformed apparent resistivities).
- Constructing combined data weighting matrix (<cite>self.Wd_stacked</cite>).
- Constructing combined spatial regularization matrix (<cite>self.Wm_stacked</cite>).
- Constructing temporal regularization matrix (<cite>self.Wt_temporal</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.TimeLapseERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_model_linear_3d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/time_lapse.html#TimeLapseERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.TimeLapseERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial_model_linear_3d</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Initial guess for the resistivity model [ohm·m] (linear scale).
Should be a 2D array of shape (num_cells, num_timesteps).
If None, a homogeneous model for each timestep is derived from the median
of its respective observed apparent resistivities. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object containing the results of the time-lapse inversion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.TimeLapseInversionResult">TimeLapseInversionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>setup()</cite> has not been called or if inversion encounters critical errors.</p></li>
<li><p><strong>ValueError</strong> – If <cite>initial_model_linear_3d</cite> has incorrect shape.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.inversion.</span></span><span class="sig-name descname"><span class="pre">WindowedTimeLapseERTInversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_dir:</span> <span class="pre">str,</span> <span class="pre">ert_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float],</span> <span class="pre">window_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for windowed time-lapse ERT inversion to handle large temporal datasets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_dir:</span> <span class="pre">str,</span> <span class="pre">ert_files:</span> <span class="pre">~typing.List[str],</span> <span class="pre">measurement_times:</span> <span class="pre">~typing.List[float],</span> <span class="pre">window_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2581465753680'&gt;</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize windowed time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> – Directory containing ERT data files</p></li>
<li><p><strong>ert_files</strong> – List of ERT data filenames</p></li>
<li><p><strong>measurement_times</strong> – List of measurement times</p></li>
<li><p><strong>window_size</strong> – Size of sliding window</p></li>
<li><p><strong>mesh</strong> – Mesh for inversion or path to mesh file</p></li>
<li><p><strong>**kwargs</strong> – Additional parameters to pass to TimeLapseERTInversion</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_parallel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_window_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="inversion.html#PyHydroGeophysX.inversion.base.TimeLapseInversionResult" title="PyHydroGeophysX.inversion.base.TimeLapseInversionResult"><span class="pre">TimeLapseInversionResult</span></a></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/inversion/windowed.html#WindowedTimeLapseERTInversion.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.inversion.WindowedTimeLapseERTInversion.run" title="Permalink to this definition"></a></dt>
<dd><p>Run windowed time-lapse ERT inversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_parallel</strong> – Whether to process windows in parallel</p></li>
<li><p><strong>max_window_workers</strong> – Maximum number of parallel workers (None for auto)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TimeLapseInversionResult with stitched results</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hang Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PyHydroGeophysX.core &mdash; PyHydroGeophysX Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="canonical" href="https://geohang.github.io/PyHydroGeophysX/api/core.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2389946f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples Gallery" href="../auto_examples/index.html" />
    <link rel="prev" title="PyHydroGeophysX.inversion" href="inversion.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyHydroGeophysX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model_output.html">PyHydroGeophysX.model_output</a></li>
<li class="toctree-l2"><a class="reference internal" href="petrophysics.html">PyHydroGeophysX.petrophysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward.html">PyHydroGeophysX.forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="inversion.html">PyHydroGeophysX.inversion</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">PyHydroGeophysX.core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.MeshCreator"><code class="docutils literal notranslate"><span class="pre">MeshCreator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.MeshCreator.__init__"><code class="docutils literal notranslate"><span class="pre">MeshCreator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.MeshCreator.create_from_layers"><code class="docutils literal notranslate"><span class="pre">MeshCreator.create_from_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.MeshCreator.create_from_ert_data"><code class="docutils literal notranslate"><span class="pre">MeshCreator.create_from_ert_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.create_mesh_from_layers"><code class="docutils literal notranslate"><span class="pre">create_mesh_from_layers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.extract_velocity_interface"><code class="docutils literal notranslate"><span class="pre">extract_velocity_interface()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.add_velocity_interface"><code class="docutils literal notranslate"><span class="pre">add_velocity_interface()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.ProfileInterpolator"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.ProfileInterpolator.__init__"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_layer_data"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator.interpolate_layer_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_3d_data"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator.interpolate_3d_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_to_mesh"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator.interpolate_to_mesh()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.interpolate_to_profile"><code class="docutils literal notranslate"><span class="pre">interpolate_to_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.setup_profile_coordinates"><code class="docutils literal notranslate"><span class="pre">setup_profile_coordinates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.interpolate_structure_to_profile"><code class="docutils literal notranslate"><span class="pre">interpolate_structure_to_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.prepare_2D_profile_data"><code class="docutils literal notranslate"><span class="pre">prepare_2D_profile_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.core.interpolate_to_mesh"><code class="docutils literal notranslate"><span class="pre">interpolate_to_mesh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PyHydroGeophysX.core.interpolation">PyHydroGeophysX.core.interpolation module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.interpolate_to_profile"><code class="docutils literal notranslate"><span class="pre">interpolate_to_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.setup_profile_coordinates"><code class="docutils literal notranslate"><span class="pre">setup_profile_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.interpolate_structure_to_profile"><code class="docutils literal notranslate"><span class="pre">interpolate_structure_to_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.prepare_2D_profile_data"><code class="docutils literal notranslate"><span class="pre">prepare_2D_profile_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.interpolate_to_mesh"><code class="docutils literal notranslate"><span class="pre">interpolate_to_mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator"><code class="docutils literal notranslate"><span class="pre">ProfileInterpolator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.interpolation.create_surface_lines"><code class="docutils literal notranslate"><span class="pre">create_surface_lines()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-PyHydroGeophysX.core.mesh_utils">PyHydroGeophysX.core.mesh_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.mesh_utils.create_mesh_from_layers"><code class="docutils literal notranslate"><span class="pre">create_mesh_from_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.mesh_utils.extract_velocity_interface"><code class="docutils literal notranslate"><span class="pre">extract_velocity_interface()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.mesh_utils.add_velocity_interface"><code class="docutils literal notranslate"><span class="pre">add_velocity_interface()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.core.mesh_utils.MeshCreator"><code class="docutils literal notranslate"><span class="pre">MeshCreator</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyHydroGeophysX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">PyHydroGeophysX.core</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/geohang/PyHydroGeophysX/blob/main/docs/source/api/core.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-PyHydroGeophysX.core">
<span id="pyhydrogeophysx-core"></span><h1>PyHydroGeophysX.core<a class="headerlink" href="#module-PyHydroGeophysX.core" title="Permalink to this heading"></a></h1>
<p>Core utilities for geophysical modeling and inversion.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.MeshCreator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">MeshCreator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.MeshCreator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for creating and managing meshes for geophysical inversion.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.MeshCreator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.MeshCreator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize MeshCreator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quality</strong> – Default mesh quality parameter for <cite>mt.createMesh</cite>.
Higher values (e.g., 30-35) generally result in better-shaped
triangles but can increase node count. Default is 30.0.</p></li>
<li><p><strong>area</strong> – Default maximum cell area constraint for <cite>mt.createMesh</cite>.
If None, no specific area constraint is applied by default, allowing
quality to primarily dictate cell sizes. Can be overridden in methods.
A smaller value leads to a finer mesh in the specified region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.MeshCreator.create_from_layers">
<span class="sig-name descname"><span class="pre">create_from_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon'</span> <span class="pre">id='2068132937296'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.create_from_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.MeshCreator.create_from_layers" title="Permalink to this definition"></a></dt>
<dd><p>Create a 2D PyGIMLi mesh from a surface polyline and a list of subsurface layer boundary polylines.</p>
<p>This method constructs a mesh where regions between the provided surface and
layer boundaries are assigned specific markers. It’s designed for models
with a defined number of horizontal-like layers.</p>
<p>Currently, this implementation specifically calls the global <cite>create_mesh_from_layers</cite>
function, which is hardcoded for exactly two subsurface layers (i.e., three regions total:
surface-to-layer1, layer1-to-layer2, layer2-to-bottom).
The <cite>layer_markers</cite> argument here is NOT used by the current underlying global function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface</strong> – Numpy array of (x, z) coordinates for the ground surface. (N_surface, 2).
Z is typically elevation or depth, ensure consistency with <cite>layers</cite> and <cite>bottom_depth</cite>.</p></li>
<li><p><strong>layers</strong> – List of numpy arrays. Each array contains (x, z) coordinates
for a subsurface layer boundary. E.g., <cite>[layer1_coords, layer2_coords]</cite>.</p></li>
<li><p><strong>bottom_depth</strong> – Absolute z-coordinate for the bottom of the entire mesh.
Convention (e.g., elevation positive up, depth positive down) must be consistent.</p></li>
<li><p><strong>layer_markers</strong> – Optional list of integer markers. Intended for future use if this
method implements generic multi-layer meshing. Currently not passed through.</p></li>
<li><p><strong>quality</strong> – Mesh quality parameter. Overrides class default <cite>self.quality</cite> if provided.</p></li>
<li><p><strong>area</strong> – Maximum cell area for the mesh. Overrides class default <cite>self.area</cite> if provided.
If None, uses class default. If class default is also None, PyGIMLi’s default (often 0, no constraint) is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mesh: The generated PyGIMLi mesh.</p></li>
<li><p>geom: The PLC geometry used to create the mesh.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (pg.Mesh, pg.meshtools.geom.Polygon)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – If the number of layers in the <cite>layers</cite> list is not 2.</p></li>
<li><p><strong>ValueError</strong> – If <cite>layers</cite> list is empty.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.MeshCreator.create_from_ert_data">
<span class="sig-name descname"><span class="pre">create_from_ert_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraMaxCellSize:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraBoundary:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaryMaxCellSize:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.create_from_ert_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.MeshCreator.create_from_ert_data" title="Permalink to this definition"></a></dt>
<dd><p>Create a mesh suitable for ERT (Electrical Resistivity Tomography) inversion.</p>
<p>This method utilizes PyGIMLi’s <cite>ERTManager</cite> to generate a mesh tailored to
the sensor configuration found in the <cite>data</cite> object. It allows customization
of various meshing parameters relevant to ERT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – PyGIMLi DataContainer object. Must contain sensor positions.</p></li>
<li><p><strong>max_depth</strong> – Maximum depth of the parametric (inversion) domain. (Corresponds to <cite>paraDepth</cite> in ERTManager).
If None, <cite>ERTManager</cite> might use a default or auto-calculate.</p></li>
<li><p><strong>quality</strong> – Mesh quality parameter. Overrides class default <cite>self.quality</cite> if provided.</p></li>
<li><p><strong>paraMaxCellSize</strong> – Maximum cell size in the parametric domain (central region with data sensitivity).</p></li>
<li><p><strong>paraBoundary</strong> – Width of the less refined boundary region surrounding the parametric domain.</p></li>
<li><p><strong>boundaryMaxCellSize</strong> – Maximum cell size in this outer boundary region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated PyGIMLi mesh, suitable for ERT forward modeling and inversion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pg.Mesh</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <cite>pygimli.physics.ert</cite> cannot be imported.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.create_mesh_from_layers">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">create_mesh_from_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon'</span> <span class="pre">id='2068132937296'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#create_mesh_from_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.create_mesh_from_layers" title="Permalink to this definition"></a></dt>
<dd><p>Create a 2D PyGIMLi mesh from three defined layer boundaries (surface, line1, line2).</p>
<p>This function constructs a mesh suitable for geophysical modeling where distinct
geological layers need to be represented with different markers. It creates
polygons for each layer and then meshes the combined geometry.</p>
<p>The markers are typically assigned as:
- Marker 2: Top layer (surface to line1) and bottom layer (below line2 to mesh bottom)
- Marker 3: Middle layer (between line1 and line2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface</strong> – Numpy array of (x, z) coordinates defining the ground surface.
Shape: (N_surface_points, 2).</p></li>
<li><p><strong>line1</strong> – Numpy array of (x, z) coordinates for the first subsurface boundary.
Shape: (N_line1_points, 2).</p></li>
<li><p><strong>line2</strong> – Numpy array of (x, z) coordinates for the second subsurface boundary.
Shape: (N_line2_points, 2).</p></li>
<li><p><strong>bottom_depth</strong> – The absolute z-coordinate for the bottom of the mesh.
Note: The original comment “Depth below surface minimum” seems
inconsistent with its usage <cite>bottom_elev = bottom_depth</cite>.
Assuming <cite>bottom_depth</cite> is an absolute elevation for the bottom.
If relative, <cite>min_surface_elev - bottom_depth</cite> would be used.</p></li>
<li><p><strong>quality</strong> – PyGIMLi mesh quality parameter. Controls the minimum angle of triangles.
Typical values are 20-35. Higher values mean better quality but more nodes.</p></li>
<li><p><strong>area</strong> – Maximum desired area for mesh cells. Smaller values lead to a finer mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mesh (pg.Mesh): The generated PyGIMLi mesh object.</p></li>
<li><p>mesh_centers (np.ndarray): Array of (x,y) coordinates for each cell center.</p></li>
<li><p>markers (np.ndarray): Array of integer markers for each cell in the mesh.</p></li>
<li><p>geom (pg.meshtools.geom.Polygon): The geometry object used to create the mesh.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.extract_velocity_interface">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">extract_velocity_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_data:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">4.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#extract_velocity_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.extract_velocity_interface" title="Permalink to this definition"></a></dt>
<dd><p>Extract an interface (e.g., bedrock) from velocity data on a mesh.</p>
<p>The function identifies points where the cell velocity values cross a given
threshold. It bins cells by their x-coordinates, finds the depth of the
threshold crossing within each bin via linear interpolation, and then
smooths the resulting interface line using cubic interpolation and a
Savitzky-Golay filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – PyGIMLi mesh object containing the cells.</p></li>
<li><p><strong>velocity_data</strong> – 1D numpy array of velocity values, one per cell in <cite>mesh</cite>.
Order must correspond to mesh.cellIDs().</p></li>
<li><p><strong>threshold</strong> – The velocity value that defines the interface (e.g., velocity of bedrock).</p></li>
<li><p><strong>interval</strong> – The width of x-coordinate bins used to sample the interface.
Smaller intervals give more detail but may be noisier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_dense (np.ndarray): 1D array of x-coordinates for the smoothed interface.</p></li>
<li><p>z_dense (np.ndarray): 1D array of z-coordinates (depths) for the smoothed interface.
Coordinate system (e.g. depth positive down, or elevation positive up) should
be consistent with the input mesh’s coordinate system.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (x_dense, z_dense)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.add_velocity_interface">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">add_velocity_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ertData:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_x:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_z:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraBoundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_marker_outside:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_above_interface:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_below_interface:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#add_velocity_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.add_velocity_interface" title="Permalink to this definition"></a></dt>
<dd><p>Incorporate a smoothed velocity interface into a mesh generated for ERT data.</p>
<p>This function first creates a standard ERT parameter mesh using PyGIMLi’s
<cite>createParaMeshPLC</cite>. It then adds the provided <cite>smooth_x, smooth_z</cite> interface
as a polyline to this geometry. Finally, it re-meshes and assigns markers
to cells based on their position relative to this interface within the main
survey area.</p>
<p>The definition of “survey area” and “above/below” depends on coordinate system conventions.
Typically, for PyGIMLi 2D meshes, Y increases downwards (depth).
- <cite>marker_above_interface</cite> (e.g., 3): Cells physically shallower than the interface.
- <cite>marker_below_interface</cite> (e.g., 2): Cells physically deeper than or on the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ertData</strong> – PyGIMLi data container (e.g., <cite>pg.DataContainer</cite>). Must have sensor positions.</p></li>
<li><p><strong>smooth_x</strong> – 1D numpy array of x-coordinates for the smoothed interface line.</p></li>
<li><p><strong>smooth_z</strong> – 1D numpy array of z-coordinates for the smoothed interface line.
The y-coordinate from PyGIMLi mesh cells (depth) will be compared against these.</p></li>
<li><p><strong>paraBoundary_ext</strong> – Extension distance for the interface line beyond the
x-range of ERT sensors. Also used by <cite>createParaMeshPLC</cite> for defining
the outer, less refined mesh region. Default is 2.0 units.</p></li>
<li><p><strong>default_marker_outside</strong> – Marker for cells considered outside the primary survey/parametric region. Default is 1.</p></li>
<li><p><strong>marker_above_interface</strong> – Marker for cells inside survey region, physically above (shallower than) the interface. Default is 3.</p></li>
<li><p><strong>marker_below_interface</strong> – Marker for cells inside survey region, on or below (deeper than) the interface. Default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>markers (np.ndarray): 1D array of final cell markers for <cite>meshafter</cite>.</p></li>
<li><dl class="simple">
<dt>meshafter (pg.Mesh): The new PyGIMLi mesh with the interface incorporated</dt><dd><p>and cell markers assigned.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (markers, meshafter)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>smooth_x</cite> or <cite>smooth_z</cite> are not 1D arrays of the same length,
    or if they have fewer than 2 points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.ProfileInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">ProfileInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.ProfileInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to simplify the process of interpolating various types of geophysical data
onto a defined 2D profile.</p>
<p>The class handles the setup of profile coordinates and provides methods
to interpolate surface data, layered structures, and 3D gridded data onto
this profile. It can also interpolate from the profile data to a 2D mesh.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.ProfileInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.ProfileInterpolator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ProfileInterpolator.</p>
<p>This involves setting up the profile coordinates based on two points
on a surface grid and calculating the surface elevation along this profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point1</strong> – List or tuple [col_idx, row_idx] for the starting grid cell of the profile.</p></li>
<li><p><strong>point2</strong> – List or tuple [col_idx, row_idx] for the ending grid cell of the profile.</p></li>
<li><p><strong>surface_data</strong> – 2D numpy array representing surface elevation or another key surface.
Used for defining grid dimensions and for optional surface profile interpolation.</p></li>
<li><p><strong>origin_x</strong> – X-coordinate of the grid’s origin (e.g., bottom-left corner).</p></li>
<li><p><strong>origin_y</strong> – Y-coordinate of the grid’s origin.</p></li>
<li><p><strong>pixel_width</strong> – The width of a single cell in the grid in Cartesian units.</p></li>
<li><p><strong>pixel_height</strong> – The height of a single cell in the grid in Cartesian units.
Often negative if row index increases downwards but Y-coordinate increases upwards.</p></li>
<li><p><strong>num_points</strong> – Number of points to discretize the profile into.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.ProfileInterpolator.interpolate_layer_data">
<span class="sig-name descname"><span class="pre">interpolate_layer_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_layer_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_layer_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple layers of 2D gridded data onto the defined profile.</p>
<p>Each layer is a 2D numpy array with the same dimensions as the initial
<cite>surface_data</cite> grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_data</strong> – A list of 2D numpy arrays. Each array represents a layer’s
data on the original grid.</p></li>
<li><p><strong>method</strong> – Interpolation method (‘linear’, ‘nearest’, ‘cubic’) to be used by
<cite>interpolate_structure_to_profile</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array containing the interpolated values for each layer along
the profile. Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.ProfileInterpolator.interpolate_3d_data">
<span class="sig-name descname"><span class="pre">interpolate_3d_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_3d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_3d_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_3d_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate 3D gridded data onto the defined profile.</p>
<p>The 3D data is expected to be an array of shape (n_layers, ny, nx),
where (ny, nx) are the dimensions of the original <cite>surface_data</cite> grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_3d</strong> – A 3D numpy array of data to interpolate.
Shape: (n_layers, ny, nx).</p></li>
<li><p><strong>method</strong> – Interpolation method (‘linear’, ‘nearest’, ‘cubic’) to be used by
<cite>prepare_2D_profile_data</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array containing the interpolated values for each layer of
the 3D data along the profile. Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.ProfileInterpolator.interpolate_to_mesh">
<span class="sig-name descname"><span class="pre">interpolate_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.ProfileInterpolator.interpolate_to_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate property values from the profile representation (distance vs. depth)
to a 2D unstructured mesh, using layer-specific interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_values</strong> – 1D or 2D numpy array of property values along the profile.
These values are associated with <cite>self.L_profile</cite> (distance)
and <cite>depth_values</cite>.</p></li>
<li><p><strong>depth_values</strong> – 2D numpy array (n_profile_layers, n_profile_points) of depth coordinates
for the <cite>property_values</cite> along the profile.</p></li>
<li><p><strong>mesh_x</strong> – 1D numpy array of X-coordinates for mesh cell centers.
For profile-to-mesh, this is often equivalent to distance along profile.</p></li>
<li><p><strong>mesh_y</strong> – 1D numpy array of Y-coordinates (depths) for mesh cell centers.</p></li>
<li><p><strong>mesh_markers</strong> – 1D numpy array of integer markers for each mesh cell,
indicating its geological layer or region.</p></li>
<li><p><strong>ID</strong> – 1D or 2D numpy array that maps points in <cite>property_values</cite> and <cite>depth_values</cite>
to specific layers, aligning them with <cite>layer_markers</cite> in the mesh.
Shape should be compatible with <cite>property_values</cite>.</p></li>
<li><p><strong>layer_markers</strong> – Optional list of integer marker values in <cite>mesh_markers</cite>
to perform interpolation for. Defaults to [3, 0, 2] if None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated property values for each cell in the mesh.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolate_to_profile">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">interpolate_to_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_to_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolate_to_profile" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate 2D gridded data onto a specified profile line.</p>
<p>This function takes 2D gridded data and interpolates it to a series of
points defining a profile line. It uses <cite>scipy.interpolate.griddata</cite>
for the interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 2D numpy array of values to interpolate.</p></li>
<li><p><strong>X_grid</strong> – 2D numpy array of X coordinates of the original grid (e.g., from np.meshgrid).</p></li>
<li><p><strong>Y_grid</strong> – 2D numpy array of Y coordinates of the original grid (e.g., from np.meshgrid).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use. Options are ‘linear’, ‘nearest’, ‘cubic’.
Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated values along the profile.
Returns an array of NaNs if interpolation fails for some points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.setup_profile_coordinates">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">setup_profile_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#setup_profile_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.setup_profile_coordinates" title="Permalink to this definition"></a></dt>
<dd><p>Set up profile coordinates based on surface elevation data between two points.</p>
<p>This function defines a profile line between two points (specified by their
indices in the <cite>surface_data</cite> grid) and generates coordinates along this
profile. It also returns the meshgrid coordinates for the entire surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point1</strong> – List or tuple of [column_index, row_index] for the starting point of the profile.</p></li>
<li><p><strong>point2</strong> – List or tuple of [column_index, row_index] for the ending point of the profile.</p></li>
<li><p><strong>surface_data</strong> – 2D numpy array of surface elevation data. Used to determine grid dimensions.</p></li>
<li><p><strong>origin_x</strong> – X coordinate of the origin (bottom-left corner) of the grid. Defaults to 0.0.</p></li>
<li><p><strong>origin_y</strong> – Y coordinate of the origin (bottom-left corner) of the grid. Defaults to 0.0.</p></li>
<li><p><strong>pixel_width</strong> – Width of each pixel/cell in the grid. Defaults to 1.0.</p></li>
<li><p><strong>pixel_height</strong> – Height of each pixel/cell in the grid.
Defaults to -1.0 (assuming image-like coordinates where Y increases downwards).
If Y increases upwards, this should be positive.</p></li>
<li><p><strong>num_points</strong> – Number of points to generate along the profile line. Defaults to 200.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>X_pro (np.ndarray): 1D array of X coordinates along the profile.</p></li>
<li><p>Y_pro (np.ndarray): 1D array of Y coordinates along the profile.</p></li>
<li><p>L_profile (np.ndarray): 1D array of distances along the profile from the start point.</p></li>
<li><p>XX (np.ndarray): 2D array of X coordinates for the entire grid (meshgrid).</p></li>
<li><p>YY (np.ndarray): 2D array of Y coordinates for the entire grid (meshgrid).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolate_structure_to_profile">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">interpolate_structure_to_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_structure_to_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolate_structure_to_profile" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple structure layers (2D grids) onto a defined profile.</p>
<p>This function iterates through a list of 2D arrays, each representing a
geological layer or structure, and interpolates each onto the given profile
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> – List of 2D numpy arrays. Each array is a grid of values
representing a layer.</p></li>
<li><p><strong>X_grid</strong> – 2D numpy array of X coordinates of the original grid (meshgrid).</p></li>
<li><p><strong>Y_grid</strong> – 2D numpy array of Y coordinates of the original grid (meshgrid).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use (e.g., ‘linear’, ‘nearest’).
Passed to <cite>interpolate_to_profile</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of interpolated values. Shape is (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.prepare_2D_profile_data">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">prepare_2D_profile_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XX</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">YY</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#prepare_2D_profile_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.prepare_2D_profile_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple 2D gridded data layers (from a 3D array) onto a profile line.</p>
<p>This function is similar to <cite>interpolate_structure_to_profile</cite> but takes a single
3D numpy array where the first dimension represents different layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 3D numpy array of gridded data with shape (n_layers, ny, nx).</p></li>
<li><p><strong>XX</strong> – 2D numpy array of X coordinates of the original grid (meshgrid from input grid dimensions).</p></li>
<li><p><strong>YY</strong> – 2D numpy array of Y coordinates of the original grid (meshgrid from input grid dimensions).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use for <cite>griddata</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of interpolated values along the profile.
Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolate_to_mesh">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.</span></span><span class="sig-name descname"><span class="pre">interpolate_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolate_to_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate property values from a 2D profile (defined by distance and depth)
onto a 2D unstructured mesh. This function handles layer-specific interpolation
based on markers.</p>
<p>The input data <cite>property_values</cite>, <cite>profile_distance</cite>, and <cite>depth_values</cite>
are expected to be structured in a way that they can be filtered by <cite>ID</cite>
which corresponds to <cite>layer_markers</cite> in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_values</strong> – 1D or 2D numpy array of property values.
If 2D, assumed shape (n_layers_in_profile_data, n_points_along_profile).
If 1D, it’s treated as a single layer or must be indexable by <cite>ID</cite>.</p></li>
<li><p><strong>profile_distance</strong> – 1D numpy array of distances along the profile.
It’s repeated to match dimensions if <cite>property_values</cite> is 2D.</p></li>
<li><p><strong>depth_values</strong> – 2D numpy array of depth values, typically (n_layers_in_profile_data, n_points_along_profile).
The slice <cite>depth_values[:14]</cite> suggests a fixed number of depth layers expected.
This should be clarified or made more flexible.</p></li>
<li><p><strong>mesh_x</strong> – 1D numpy array of X coordinates of the mesh cell centers.</p></li>
<li><p><strong>mesh_y</strong> – 1D numpy array of Y coordinates of the mesh cell centers (typically depths).</p></li>
<li><p><strong>mesh_markers</strong> – 1D numpy array of integer markers for each mesh cell, indicating its layer/region.</p></li>
<li><p><strong>ID</strong> – 1D or 2D numpy array used for filtering <cite>property_values</cite>, <cite>profile_distance</cite>, and <cite>depth_values</cite>
to match specific <cite>layer_markers</cite>. Its shape should be compatible with <cite>property_values</cite>.
This <cite>ID</cite> array seems to map points in <cite>property_values</cite> to specific layers.</p></li>
<li><p><strong>layer_markers</strong> – List of integer marker values present in <cite>mesh_markers</cite> for which
interpolation should be performed. If None, it defaults to [3, 0, 2].
It’s recommended to derive this from <cite>np.unique(mesh_markers)</cite> if appropriate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated values for each mesh cell, preserving the order of <cite>mesh_x</cite>/<cite>mesh_y</cite>.</p>
</dd>
</dl>
</dd></dl>

<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-PyHydroGeophysX.core.interpolation">
<span id="pyhydrogeophysx-core-interpolation-module"></span><h2>PyHydroGeophysX.core.interpolation module<a class="headerlink" href="#module-PyHydroGeophysX.core.interpolation" title="Permalink to this heading"></a></h2>
<p>Interpolation utilities for geophysical data processing.</p>
<p>This module provides functions and a class for interpolating geophysical data,
primarily for creating 2D profiles from 3D datasets and for interpolating
profile data onto a 2D mesh.</p>
<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.interpolate_to_profile">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">interpolate_to_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_to_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.interpolate_to_profile" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate 2D gridded data onto a specified profile line.</p>
<p>This function takes 2D gridded data and interpolates it to a series of
points defining a profile line. It uses <cite>scipy.interpolate.griddata</cite>
for the interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 2D numpy array of values to interpolate.</p></li>
<li><p><strong>X_grid</strong> – 2D numpy array of X coordinates of the original grid (e.g., from np.meshgrid).</p></li>
<li><p><strong>Y_grid</strong> – 2D numpy array of Y coordinates of the original grid (e.g., from np.meshgrid).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use. Options are ‘linear’, ‘nearest’, ‘cubic’.
Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated values along the profile.
Returns an array of NaNs if interpolation fails for some points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.setup_profile_coordinates">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">setup_profile_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#setup_profile_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.setup_profile_coordinates" title="Permalink to this definition"></a></dt>
<dd><p>Set up profile coordinates based on surface elevation data between two points.</p>
<p>This function defines a profile line between two points (specified by their
indices in the <cite>surface_data</cite> grid) and generates coordinates along this
profile. It also returns the meshgrid coordinates for the entire surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point1</strong> – List or tuple of [column_index, row_index] for the starting point of the profile.</p></li>
<li><p><strong>point2</strong> – List or tuple of [column_index, row_index] for the ending point of the profile.</p></li>
<li><p><strong>surface_data</strong> – 2D numpy array of surface elevation data. Used to determine grid dimensions.</p></li>
<li><p><strong>origin_x</strong> – X coordinate of the origin (bottom-left corner) of the grid. Defaults to 0.0.</p></li>
<li><p><strong>origin_y</strong> – Y coordinate of the origin (bottom-left corner) of the grid. Defaults to 0.0.</p></li>
<li><p><strong>pixel_width</strong> – Width of each pixel/cell in the grid. Defaults to 1.0.</p></li>
<li><p><strong>pixel_height</strong> – Height of each pixel/cell in the grid.
Defaults to -1.0 (assuming image-like coordinates where Y increases downwards).
If Y increases upwards, this should be positive.</p></li>
<li><p><strong>num_points</strong> – Number of points to generate along the profile line. Defaults to 200.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>X_pro (np.ndarray): 1D array of X coordinates along the profile.</p></li>
<li><p>Y_pro (np.ndarray): 1D array of Y coordinates along the profile.</p></li>
<li><p>L_profile (np.ndarray): 1D array of distances along the profile from the start point.</p></li>
<li><p>XX (np.ndarray): 2D array of X coordinates for the entire grid (meshgrid).</p></li>
<li><p>YY (np.ndarray): 2D array of Y coordinates for the entire grid (meshgrid).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.interpolate_structure_to_profile">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">interpolate_structure_to_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_structure_to_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.interpolate_structure_to_profile" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple structure layers (2D grids) onto a defined profile.</p>
<p>This function iterates through a list of 2D arrays, each representing a
geological layer or structure, and interpolates each onto the given profile
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> – List of 2D numpy arrays. Each array is a grid of values
representing a layer.</p></li>
<li><p><strong>X_grid</strong> – 2D numpy array of X coordinates of the original grid (meshgrid).</p></li>
<li><p><strong>Y_grid</strong> – 2D numpy array of Y coordinates of the original grid (meshgrid).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use (e.g., ‘linear’, ‘nearest’).
Passed to <cite>interpolate_to_profile</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of interpolated values. Shape is (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.prepare_2D_profile_data">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">prepare_2D_profile_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XX</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">YY</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_pro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#prepare_2D_profile_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.prepare_2D_profile_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple 2D gridded data layers (from a 3D array) onto a profile line.</p>
<p>This function is similar to <cite>interpolate_structure_to_profile</cite> but takes a single
3D numpy array where the first dimension represents different layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 3D numpy array of gridded data with shape (n_layers, ny, nx).</p></li>
<li><p><strong>XX</strong> – 2D numpy array of X coordinates of the original grid (meshgrid from input grid dimensions).</p></li>
<li><p><strong>YY</strong> – 2D numpy array of Y coordinates of the original grid (meshgrid from input grid dimensions).</p></li>
<li><p><strong>X_pro</strong> – 1D numpy array of X coordinates of the profile points.</p></li>
<li><p><strong>Y_pro</strong> – 1D numpy array of Y coordinates of the profile points.</p></li>
<li><p><strong>method</strong> – Interpolation method to use for <cite>griddata</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of interpolated values along the profile.
Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.interpolate_to_mesh">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">interpolate_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#interpolate_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.interpolate_to_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate property values from a 2D profile (defined by distance and depth)
onto a 2D unstructured mesh. This function handles layer-specific interpolation
based on markers.</p>
<p>The input data <cite>property_values</cite>, <cite>profile_distance</cite>, and <cite>depth_values</cite>
are expected to be structured in a way that they can be filtered by <cite>ID</cite>
which corresponds to <cite>layer_markers</cite> in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_values</strong> – 1D or 2D numpy array of property values.
If 2D, assumed shape (n_layers_in_profile_data, n_points_along_profile).
If 1D, it’s treated as a single layer or must be indexable by <cite>ID</cite>.</p></li>
<li><p><strong>profile_distance</strong> – 1D numpy array of distances along the profile.
It’s repeated to match dimensions if <cite>property_values</cite> is 2D.</p></li>
<li><p><strong>depth_values</strong> – 2D numpy array of depth values, typically (n_layers_in_profile_data, n_points_along_profile).
The slice <cite>depth_values[:14]</cite> suggests a fixed number of depth layers expected.
This should be clarified or made more flexible.</p></li>
<li><p><strong>mesh_x</strong> – 1D numpy array of X coordinates of the mesh cell centers.</p></li>
<li><p><strong>mesh_y</strong> – 1D numpy array of Y coordinates of the mesh cell centers (typically depths).</p></li>
<li><p><strong>mesh_markers</strong> – 1D numpy array of integer markers for each mesh cell, indicating its layer/region.</p></li>
<li><p><strong>ID</strong> – 1D or 2D numpy array used for filtering <cite>property_values</cite>, <cite>profile_distance</cite>, and <cite>depth_values</cite>
to match specific <cite>layer_markers</cite>. Its shape should be compatible with <cite>property_values</cite>.
This <cite>ID</cite> array seems to map points in <cite>property_values</cite> to specific layers.</p></li>
<li><p><strong>layer_markers</strong> – List of integer marker values present in <cite>mesh_markers</cite> for which
interpolation should be performed. If None, it defaults to [3, 0, 2].
It’s recommended to derive this from <cite>np.unique(mesh_markers)</cite> if appropriate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated values for each mesh cell, preserving the order of <cite>mesh_x</cite>/<cite>mesh_y</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.ProfileInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">ProfileInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to simplify the process of interpolating various types of geophysical data
onto a defined 2D profile.</p>
<p>The class handles the setup of profile coordinates and provides methods
to interpolate surface data, layered structures, and 3D gridded data onto
this profile. It can also interpolate from the profile data to a 2D mesh.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.ProfileInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ProfileInterpolator.</p>
<p>This involves setting up the profile coordinates based on two points
on a surface grid and calculating the surface elevation along this profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point1</strong> – List or tuple [col_idx, row_idx] for the starting grid cell of the profile.</p></li>
<li><p><strong>point2</strong> – List or tuple [col_idx, row_idx] for the ending grid cell of the profile.</p></li>
<li><p><strong>surface_data</strong> – 2D numpy array representing surface elevation or another key surface.
Used for defining grid dimensions and for optional surface profile interpolation.</p></li>
<li><p><strong>origin_x</strong> – X-coordinate of the grid’s origin (e.g., bottom-left corner).</p></li>
<li><p><strong>origin_y</strong> – Y-coordinate of the grid’s origin.</p></li>
<li><p><strong>pixel_width</strong> – The width of a single cell in the grid in Cartesian units.</p></li>
<li><p><strong>pixel_height</strong> – The height of a single cell in the grid in Cartesian units.
Often negative if row index increases downwards but Y-coordinate increases upwards.</p></li>
<li><p><strong>num_points</strong> – Number of points to discretize the profile into.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_layer_data">
<span class="sig-name descname"><span class="pre">interpolate_layer_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_layer_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_layer_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate multiple layers of 2D gridded data onto the defined profile.</p>
<p>Each layer is a 2D numpy array with the same dimensions as the initial
<cite>surface_data</cite> grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_data</strong> – A list of 2D numpy arrays. Each array represents a layer’s
data on the original grid.</p></li>
<li><p><strong>method</strong> – Interpolation method (‘linear’, ‘nearest’, ‘cubic’) to be used by
<cite>interpolate_structure_to_profile</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array containing the interpolated values for each layer along
the profile. Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_3d_data">
<span class="sig-name descname"><span class="pre">interpolate_3d_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_3d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_3d_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_3d_data" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate 3D gridded data onto the defined profile.</p>
<p>The 3D data is expected to be an array of shape (n_layers, ny, nx),
where (ny, nx) are the dimensions of the original <cite>surface_data</cite> grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_3d</strong> – A 3D numpy array of data to interpolate.
Shape: (n_layers, ny, nx).</p></li>
<li><p><strong>method</strong> – Interpolation method (‘linear’, ‘nearest’, ‘cubic’) to be used by
<cite>prepare_2D_profile_data</cite>. Defaults to ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array containing the interpolated values for each layer of
the 3D data along the profile. Shape: (n_layers, n_profile_points).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_to_mesh">
<span class="sig-name descname"><span class="pre">interpolate_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#ProfileInterpolator.interpolate_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.ProfileInterpolator.interpolate_to_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate property values from the profile representation (distance vs. depth)
to a 2D unstructured mesh, using layer-specific interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_values</strong> – 1D or 2D numpy array of property values along the profile.
These values are associated with <cite>self.L_profile</cite> (distance)
and <cite>depth_values</cite>.</p></li>
<li><p><strong>depth_values</strong> – 2D numpy array (n_profile_layers, n_profile_points) of depth coordinates
for the <cite>property_values</cite> along the profile.</p></li>
<li><p><strong>mesh_x</strong> – 1D numpy array of X-coordinates for mesh cell centers.
For profile-to-mesh, this is often equivalent to distance along profile.</p></li>
<li><p><strong>mesh_y</strong> – 1D numpy array of Y-coordinates (depths) for mesh cell centers.</p></li>
<li><p><strong>mesh_markers</strong> – 1D numpy array of integer markers for each mesh cell,
indicating its geological layer or region.</p></li>
<li><p><strong>ID</strong> – 1D or 2D numpy array that maps points in <cite>property_values</cite> and <cite>depth_values</cite>
to specific layers, aligning them with <cite>layer_markers</cite> in the mesh.
Shape should be compatible with <cite>property_values</cite>.</p></li>
<li><p><strong>layer_markers</strong> – Optional list of integer marker values in <cite>mesh_markers</cite>
to perform interpolation for. Defaults to [3, 0, 2] if None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D numpy array of interpolated property values for each cell in the mesh.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.interpolation.create_surface_lines">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.interpolation.</span></span><span class="sig-name descname"><span class="pre">create_surface_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_on_profile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bot_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/interpolation.html#create_surface_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.interpolation.create_surface_lines" title="Permalink to this definition"></a></dt>
<dd><p>Extract specific layer boundaries from interpolated structure data along a profile
to create 2D lines (e.g., for plotting or mesh generation).</p>
<p>The function takes structure data (already interpolated onto a profile) and
extracts rows specified by indices to represent different geological surfaces
or boundaries. These are returned as (N, 2) arrays where N is the number
of points along the profile, column 0 is distance along profile, and column 1 is elevation/depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L_profile</strong> – 1D numpy array of distances along the profile.</p></li>
<li><p><strong>structure_on_profile</strong> – 2D numpy array (n_layers, n_profile_points) of interpolated
values (e.g., elevations or depths) for each layer
along the profile.</p></li>
<li><p><strong>top_idx</strong> – Index of the row in <cite>structure_on_profile</cite> that represents the top surface.</p></li>
<li><p><strong>mid_idx</strong> – Index of the row for a middle boundary/surface.</p></li>
<li><p><strong>bot_idx</strong> – Index of the row for a bottom boundary/surface.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>surface_line: Coordinates [L_profile, S1_elevations] for the top surface.</p></li>
<li><p>boundary_line1: Coordinates [L_profile, S2_elevations] for the middle boundary.</p></li>
<li><p>boundary_line2: Coordinates [L_profile, S3_elevations] for the bottom boundary.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing three (N, 2) numpy arrays</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-PyHydroGeophysX.core.mesh_utils">
<span id="pyhydrogeophysx-core-mesh-utils-module"></span><h2>PyHydroGeophysX.core.mesh_utils module<a class="headerlink" href="#module-PyHydroGeophysX.core.mesh_utils" title="Permalink to this heading"></a></h2>
<p>Mesh utilities for geophysical modeling and inversion using PyGIMLi.</p>
<p>This module provides functions and a class for creating and manipulating
2D meshes, particularly for incorporating geological layer information or
velocity interfaces into the mesh structure.</p>
<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.create_mesh_from_layers">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.mesh_utils.</span></span><span class="sig-name descname"><span class="pre">create_mesh_from_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon'</span> <span class="pre">id='2068132937296'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#create_mesh_from_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.create_mesh_from_layers" title="Permalink to this definition"></a></dt>
<dd><p>Create a 2D PyGIMLi mesh from three defined layer boundaries (surface, line1, line2).</p>
<p>This function constructs a mesh suitable for geophysical modeling where distinct
geological layers need to be represented with different markers. It creates
polygons for each layer and then meshes the combined geometry.</p>
<p>The markers are typically assigned as:
- Marker 2: Top layer (surface to line1) and bottom layer (below line2 to mesh bottom)
- Marker 3: Middle layer (between line1 and line2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface</strong> – Numpy array of (x, z) coordinates defining the ground surface.
Shape: (N_surface_points, 2).</p></li>
<li><p><strong>line1</strong> – Numpy array of (x, z) coordinates for the first subsurface boundary.
Shape: (N_line1_points, 2).</p></li>
<li><p><strong>line2</strong> – Numpy array of (x, z) coordinates for the second subsurface boundary.
Shape: (N_line2_points, 2).</p></li>
<li><p><strong>bottom_depth</strong> – The absolute z-coordinate for the bottom of the mesh.
Note: The original comment “Depth below surface minimum” seems
inconsistent with its usage <cite>bottom_elev = bottom_depth</cite>.
Assuming <cite>bottom_depth</cite> is an absolute elevation for the bottom.
If relative, <cite>min_surface_elev - bottom_depth</cite> would be used.</p></li>
<li><p><strong>quality</strong> – PyGIMLi mesh quality parameter. Controls the minimum angle of triangles.
Typical values are 20-35. Higher values mean better quality but more nodes.</p></li>
<li><p><strong>area</strong> – Maximum desired area for mesh cells. Smaller values lead to a finer mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mesh (pg.Mesh): The generated PyGIMLi mesh object.</p></li>
<li><p>mesh_centers (np.ndarray): Array of (x,y) coordinates for each cell center.</p></li>
<li><p>markers (np.ndarray): Array of integer markers for each cell in the mesh.</p></li>
<li><p>geom (pg.meshtools.geom.Polygon): The geometry object used to create the mesh.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.extract_velocity_interface">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.mesh_utils.</span></span><span class="sig-name descname"><span class="pre">extract_velocity_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_data:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">4.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#extract_velocity_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.extract_velocity_interface" title="Permalink to this definition"></a></dt>
<dd><p>Extract an interface (e.g., bedrock) from velocity data on a mesh.</p>
<p>The function identifies points where the cell velocity values cross a given
threshold. It bins cells by their x-coordinates, finds the depth of the
threshold crossing within each bin via linear interpolation, and then
smooths the resulting interface line using cubic interpolation and a
Savitzky-Golay filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – PyGIMLi mesh object containing the cells.</p></li>
<li><p><strong>velocity_data</strong> – 1D numpy array of velocity values, one per cell in <cite>mesh</cite>.
Order must correspond to mesh.cellIDs().</p></li>
<li><p><strong>threshold</strong> – The velocity value that defines the interface (e.g., velocity of bedrock).</p></li>
<li><p><strong>interval</strong> – The width of x-coordinate bins used to sample the interface.
Smaller intervals give more detail but may be noisier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_dense (np.ndarray): 1D array of x-coordinates for the smoothed interface.</p></li>
<li><p>z_dense (np.ndarray): 1D array of z-coordinates (depths) for the smoothed interface.
Coordinate system (e.g. depth positive down, or elevation positive up) should
be consistent with the input mesh’s coordinate system.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (x_dense, z_dense)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.add_velocity_interface">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.mesh_utils.</span></span><span class="sig-name descname"><span class="pre">add_velocity_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ertData:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_x:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_z:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraBoundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_marker_outside:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_above_interface:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_below_interface:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#add_velocity_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.add_velocity_interface" title="Permalink to this definition"></a></dt>
<dd><p>Incorporate a smoothed velocity interface into a mesh generated for ERT data.</p>
<p>This function first creates a standard ERT parameter mesh using PyGIMLi’s
<cite>createParaMeshPLC</cite>. It then adds the provided <cite>smooth_x, smooth_z</cite> interface
as a polyline to this geometry. Finally, it re-meshes and assigns markers
to cells based on their position relative to this interface within the main
survey area.</p>
<p>The definition of “survey area” and “above/below” depends on coordinate system conventions.
Typically, for PyGIMLi 2D meshes, Y increases downwards (depth).
- <cite>marker_above_interface</cite> (e.g., 3): Cells physically shallower than the interface.
- <cite>marker_below_interface</cite> (e.g., 2): Cells physically deeper than or on the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ertData</strong> – PyGIMLi data container (e.g., <cite>pg.DataContainer</cite>). Must have sensor positions.</p></li>
<li><p><strong>smooth_x</strong> – 1D numpy array of x-coordinates for the smoothed interface line.</p></li>
<li><p><strong>smooth_z</strong> – 1D numpy array of z-coordinates for the smoothed interface line.
The y-coordinate from PyGIMLi mesh cells (depth) will be compared against these.</p></li>
<li><p><strong>paraBoundary_ext</strong> – Extension distance for the interface line beyond the
x-range of ERT sensors. Also used by <cite>createParaMeshPLC</cite> for defining
the outer, less refined mesh region. Default is 2.0 units.</p></li>
<li><p><strong>default_marker_outside</strong> – Marker for cells considered outside the primary survey/parametric region. Default is 1.</p></li>
<li><p><strong>marker_above_interface</strong> – Marker for cells inside survey region, physically above (shallower than) the interface. Default is 3.</p></li>
<li><p><strong>marker_below_interface</strong> – Marker for cells inside survey region, on or below (deeper than) the interface. Default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>markers (np.ndarray): 1D array of final cell markers for <cite>meshafter</cite>.</p></li>
<li><dl class="simple">
<dt>meshafter (pg.Mesh): The new PyGIMLi mesh with the interface incorporated</dt><dd><p>and cell markers assigned.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (markers, meshafter)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>smooth_x</cite> or <cite>smooth_z</cite> are not 1D arrays of the same length,
    or if they have fewer than 2 points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.MeshCreator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.core.mesh_utils.</span></span><span class="sig-name descname"><span class="pre">MeshCreator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.MeshCreator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for creating and managing meshes for geophysical inversion.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.MeshCreator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.MeshCreator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize MeshCreator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quality</strong> – Default mesh quality parameter for <cite>mt.createMesh</cite>.
Higher values (e.g., 30-35) generally result in better-shaped
triangles but can increase node count. Default is 30.0.</p></li>
<li><p><strong>area</strong> – Default maximum cell area constraint for <cite>mt.createMesh</cite>.
If None, no specific area constraint is applied by default, allowing
quality to primarily dictate cell sizes. Can be overridden in methods.
A smaller value leads to a finer mesh in the specified region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.MeshCreator.create_from_layers">
<span class="sig-name descname"><span class="pre">create_from_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon'</span> <span class="pre">id='2068132937296'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.create_from_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.MeshCreator.create_from_layers" title="Permalink to this definition"></a></dt>
<dd><p>Create a 2D PyGIMLi mesh from a surface polyline and a list of subsurface layer boundary polylines.</p>
<p>This method constructs a mesh where regions between the provided surface and
layer boundaries are assigned specific markers. It’s designed for models
with a defined number of horizontal-like layers.</p>
<p>Currently, this implementation specifically calls the global <cite>create_mesh_from_layers</cite>
function, which is hardcoded for exactly two subsurface layers (i.e., three regions total:
surface-to-layer1, layer1-to-layer2, layer2-to-bottom).
The <cite>layer_markers</cite> argument here is NOT used by the current underlying global function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface</strong> – Numpy array of (x, z) coordinates for the ground surface. (N_surface, 2).
Z is typically elevation or depth, ensure consistency with <cite>layers</cite> and <cite>bottom_depth</cite>.</p></li>
<li><p><strong>layers</strong> – List of numpy arrays. Each array contains (x, z) coordinates
for a subsurface layer boundary. E.g., <cite>[layer1_coords, layer2_coords]</cite>.</p></li>
<li><p><strong>bottom_depth</strong> – Absolute z-coordinate for the bottom of the entire mesh.
Convention (e.g., elevation positive up, depth positive down) must be consistent.</p></li>
<li><p><strong>layer_markers</strong> – Optional list of integer markers. Intended for future use if this
method implements generic multi-layer meshing. Currently not passed through.</p></li>
<li><p><strong>quality</strong> – Mesh quality parameter. Overrides class default <cite>self.quality</cite> if provided.</p></li>
<li><p><strong>area</strong> – Maximum cell area for the mesh. Overrides class default <cite>self.area</cite> if provided.
If None, uses class default. If class default is also None, PyGIMLi’s default (often 0, no constraint) is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>mesh: The generated PyGIMLi mesh.</p></li>
<li><p>geom: The PLC geometry used to create the mesh.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple (pg.Mesh, pg.meshtools.geom.Polygon)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – If the number of layers in the <cite>layers</cite> list is not 2.</p></li>
<li><p><strong>ValueError</strong> – If <cite>layers</cite> list is empty.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.core.mesh_utils.MeshCreator.create_from_ert_data">
<span class="sig-name descname"><span class="pre">create_from_ert_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraMaxCellSize:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paraBoundary:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundaryMaxCellSize:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/core/mesh_utils.html#MeshCreator.create_from_ert_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.core.mesh_utils.MeshCreator.create_from_ert_data" title="Permalink to this definition"></a></dt>
<dd><p>Create a mesh suitable for ERT (Electrical Resistivity Tomography) inversion.</p>
<p>This method utilizes PyGIMLi’s <cite>ERTManager</cite> to generate a mesh tailored to
the sensor configuration found in the <cite>data</cite> object. It allows customization
of various meshing parameters relevant to ERT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – PyGIMLi DataContainer object. Must contain sensor positions.</p></li>
<li><p><strong>max_depth</strong> – Maximum depth of the parametric (inversion) domain. (Corresponds to <cite>paraDepth</cite> in ERTManager).
If None, <cite>ERTManager</cite> might use a default or auto-calculate.</p></li>
<li><p><strong>quality</strong> – Mesh quality parameter. Overrides class default <cite>self.quality</cite> if provided.</p></li>
<li><p><strong>paraMaxCellSize</strong> – Maximum cell size in the parametric domain (central region with data sensitivity).</p></li>
<li><p><strong>paraBoundary</strong> – Width of the less refined boundary region surrounding the parametric domain.</p></li>
<li><p><strong>boundaryMaxCellSize</strong> – Maximum cell size in this outer boundary region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated PyGIMLi mesh, suitable for ERT forward modeling and inversion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pg.Mesh</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <cite>pygimli.physics.ert</cite> cannot be imported.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="inversion.html" class="btn btn-neutral float-left" title="PyHydroGeophysX.inversion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../auto_examples/index.html" class="btn btn-neutral float-right" title="Examples Gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hang Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
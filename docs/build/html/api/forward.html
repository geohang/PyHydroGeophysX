<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PyHydroGeophysX.forward &mdash; PyHydroGeophysX Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="canonical" href="https://geohang.github.io/PyHydroGeophysX/api/forward.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2389946f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PyHydroGeophysX.inversion" href="inversion.html" />
    <link rel="prev" title="PyHydroGeophysX.petrophysics" href="petrophysics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyHydroGeophysX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model_output.html">PyHydroGeophysX.model_output</a></li>
<li class="toctree-l2"><a class="reference internal" href="petrophysics.html">PyHydroGeophysX.petrophysics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">PyHydroGeophysX.forward</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.__init__"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.set_data"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.set_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.set_mesh"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.set_mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.forward"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.forward_and_jacobian"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.forward_and_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.get_coverage"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.get_coverage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ERTForwardModeling.create_synthetic_data"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling.create_synthetic_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.ertforward"><code class="docutils literal notranslate"><span class="pre">ertforward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.ertforward2"><code class="docutils literal notranslate"><span class="pre">ertforward2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.ertforandjac"><code class="docutils literal notranslate"><span class="pre">ertforandjac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.ertforandjac2"><code class="docutils literal notranslate"><span class="pre">ertforandjac2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.__init__"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.set_scheme"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.set_scheme()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.set_mesh"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.set_mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.forward"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.create_synthetic_data"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.create_synthetic_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.SeismicForwardModeling.draw_first_picks"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling.draw_first_picks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PyHydroGeophysX.forward.ert_forward">PyHydroGeophysX.forward.ert_forward module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling"><code class="docutils literal notranslate"><span class="pre">ERTForwardModeling</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ert_forward.ertforward"><code class="docutils literal notranslate"><span class="pre">ertforward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ert_forward.ertforward2"><code class="docutils literal notranslate"><span class="pre">ertforward2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ert_forward.ertforandjac"><code class="docutils literal notranslate"><span class="pre">ertforandjac()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.ert_forward.ertforandjac2"><code class="docutils literal notranslate"><span class="pre">ertforandjac2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-PyHydroGeophysX.forward.srt_forward">PyHydroGeophysX.forward.srt_forward module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling"><code class="docutils literal notranslate"><span class="pre">SeismicForwardModeling</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inversion.html">PyHydroGeophysX.inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">PyHydroGeophysX.core</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyHydroGeophysX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">PyHydroGeophysX.forward</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/geohang/PyHydroGeophysX/blob/main/docs/source/api/forward.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-PyHydroGeophysX.forward">
<span id="pyhydrogeophysx-forward"></span><h1>PyHydroGeophysX.forward<a class="headerlink" href="#module-PyHydroGeophysX.forward" title="Permalink to this heading"></a></h1>
<p>Forward modeling utilities for geophysical simulations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">ERTForwardModeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform ERT forward modeling using PyGIMLi.</p>
<p>This class wraps PyGIMLi’s <cite>ert.ERTModelling</cite> operator, providing methods
to compute synthetic ERT data (apparent resistivities), calculate Jacobian matrices,
and estimate data coverage (resolution). It handles log transformations
for models and data if specified.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ERTForwardModeling class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object representing the subsurface model domain.
The mesh should be suitable for ERT simulation (e.g., 2D or 3D).</p></li>
<li><p><strong>data_scheme</strong> (<em>Optional</em><em>[</em><em>pg.DataContainer</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi DataContainer object defining the ERT measurement scheme
(electrode configurations, etc.). If provided, it’s set on the
forward operator. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.set_data" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the ERT data scheme for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_scheme</strong> (<em>pg.DataContainer</em>) – The PyGIMLi DataContainer defining
the measurement configurations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.set_mesh">
<span class="sig-name descname"><span class="pre">set_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.set_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.set_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the PyGIMLi mesh for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> (<em>pg.Mesh</em>) – The PyGIMLi mesh object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_response:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward ERT response (apparent resistivities) for a given resistivity model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – The resistivity model values for each cell in the mesh [ohm·m].
Can be a NumPy array or a PyGIMLi RVector.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>resistivity_model</cite> is assumed to be log10-resistivity or
ln-resistivity. The method will exponentiate it (base e for ln)
before using it in the forward calculation. Defaults to True.
(Note: Original code uses <cite>np.exp</cite>, implying natural log for model).</p></li>
<li><p><strong>log_transform_response</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the computed apparent resistivities will be log-transformed (natural log)
before being returned. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A NumPy array of the computed forward response values</dt><dd><p>(apparent resistivities). Log-transformed if specified.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the forward operator fails (e.g., if data scheme not set).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.forward_and_jacobian">
<span class="sig-name descname"><span class="pre">forward_and_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_response:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.forward_and_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.forward_and_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward ERT response and the Jacobian matrix.</p>
<p>The Jacobian J_ij = ∂d_i / ∂m_j, where d_i is the i-th data point and
m_j is the j-th model parameter (cell resistivity).
If log transformations are used, the Jacobian is adjusted accordingly:
- If model is log(m) and data is log(d): J_log = (∂log(d) / ∂log(m)) = (m/d) * (∂d/∂m)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – Resistivity model values [ohm·m] or log-resistivity.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, input model is log-transformed (natural log).
Defaults to True.</p></li>
<li><p><strong>log_transform_response</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returned response and Jacobian
are for log-transformed data. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>response (np.ndarray): Forward response (apparent resistivities), potentially log-transformed.</p></li>
<li><dl class="simple">
<dt>jacobian_matrix (np.ndarray): The Jacobian matrix, adjusted for log transforms if specified.</dt><dd><p>Shape (n_data, n_model_cells).</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If data scheme not set or Jacobian creation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.get_coverage" title="Permalink to this definition"></a></dt>
<dd><p>Compute data coverage (approximate resolution or sensitivity density) for the mesh cells.</p>
<p>This uses PyGIMLi’s <cite>coverageDCtrans</cite> which typically computes the diagonal
of J^T * diag(1/d^2) * J, often related to sensitivity or resolution matrix diagonal.
The result is then weighted by cell sizes and log10 transformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – Resistivity model values [ohm·m] or log-resistivity.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, input model is log-transformed (natural log).
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of log10-transformed coverage values for each cell in the parameter domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If data scheme not set or Jacobian/response calculation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ERTForwardModeling.create_synthetic_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xpos_electrodes:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypos_electrodes:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resistivity_values:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'wa'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level_relative:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_abs_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_error_for_estimation:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x_bound:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y_bound:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">100.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.create_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ERTForwardModeling.create_synthetic_data" title="Permalink to this definition"></a></dt>
<dd><p>Create synthetic ERT data using forward modeling.</p>
<p>This class method simulates an ERT survey by:
1. Defining electrode positions.
2. Creating a measurement scheme (e.g., Wenner, Dipole-Dipole).
3. Generating or using a provided mesh for the forward calculation.
4. Assigning resistivity values to the mesh cells.
5. Computing synthetic apparent resistivities using the ERT forward operator.
6. Optionally adding Gaussian noise to the synthetic data.
7. Optionally saving the data and displaying a pseudosection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpos_electrodes</strong> (<em>np.ndarray</em>) – 1D NumPy array of X-coordinates for electrodes [m].</p></li>
<li><p><strong>ypos_electrodes</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – 1D NumPy array of Y-coordinates (depth/elevation)
for electrodes [m]. If None, assumes a flat
surface (all Y=0). Defaults to None.</p></li>
<li><p><strong>fwd_mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh to use for forward modeling.
If None, a simple rectangular mesh is created based on
electrode positions. Defaults to None.</p></li>
<li><p><strong>resistivity_values</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Resistivity values [ohm·m] for each cell of the <cite>fwd_mesh</cite>.
If None, a default homogeneous resistivity (100 ohm·m) is used.
Must match the number of cells in <cite>fwd_mesh</cite>. Defaults to None.</p></li>
<li><p><strong>scheme_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the ERT array configuration to use (e.g., ‘wa’ for Wenner alpha,
‘dd’ for dipole-dipole, ‘schlumberger’, ‘gr’ for gradient).
Passed to <cite>ert.createData</cite>. Defaults to ‘wa’.</p></li>
<li><p><strong>noise_level_relative</strong> (<em>float</em><em>, </em><em>optional</em>) – Relative level of Gaussian noise to add to the
synthetic data (e.g., 0.05 for 5% noise).
Noise is calculated as <cite>data * (1 + N(0,1)*noise_level_relative)</cite>.
Defaults to 0.05.</p></li>
<li><p><strong>noise_abs_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute error component used for error estimation
by <cite>ert.ERTManager().estimateError()</cite>. Typically in units of the
measured quantity if that were voltage (e.g., uV), or ohm-m if data is already rhoa.
Defaults to 0.0.</p></li>
<li><p><strong>relative_error_for_estimation</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Relative error percentage for
<cite>ert.ERTManager().estimateError()</cite>.
If None, <cite>noise_level_relative</cite> is used. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – File path to save the generated synthetic data
(e.g., ‘synthetic_data.dat’). If None, data is not saved.
Defaults to None.</p></li>
<li><p><strong>show_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays a pseudosection of the generated data.
Defaults to False.</p></li>
<li><p><strong>random_seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Seed for the random number generator to ensure
reproducible noise. If None, noise will vary.
Defaults to None.</p></li>
<li><p><strong>mesh_x_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Horizontal boundary extension factor/distance if a new mesh
is created. Used by <cite>pg.meshtools.appendTriangleBoundary</cite>.
Defaults to 100.0.</p></li>
<li><p><strong>mesh_y_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Vertical boundary extension factor/distance if a new mesh
is created. Defaults to 100.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>synth_data (pg.DataContainer): The generated synthetic ERT data with ‘rhoa’ and ‘err’ fields.</p></li>
<li><p>simulation_mesh (pg.Mesh): The PyGIMLi mesh used for the forward simulation.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pg.DataContainer, pg.Mesh]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>xpos_electrodes</cite> is empty or if <cite>ypos_electrodes</cite> (if provided)
    does not match <cite>xpos_electrodes</cite> length, or if resistivity_values
    length doesn’t match mesh cell count.</p></li>
<li><p><strong>TypeError</strong> – If inputs are of incorrect type.</p></li>
<li><p><strong>RuntimeError</strong> – If PyGIMLi scheme creation or forward modeling fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ertforward">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">ertforward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_with_markers:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhomodel_background:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_active_log:</span> <span class="pre">~numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Vector'</span> <span class="pre">id='2068140016080'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ertforward" title="Permalink to this definition"></a></dt>
<dd><p>Performs ERT forward modeling, updating only a specific region of the model.</p>
<p>This function takes an existing background resistivity model (<cite>rhomodel_background</cite>),
updates a portion of it (where cell markers == 2 in <cite>mesh_with_markers</cite>)
with new log-transformed resistivity values (<cite>xr_active_log</cite>), and then computes
the forward response. The response is returned as log-transformed apparent resistivities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.
Must have data scheme and full forward mesh already set.
The full forward mesh should be consistent with <cite>rhomodel_background</cite>.</p></li>
<li><p><strong>mesh_with_markers</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object whose cell markers define the active region.
Cells with marker 2 will be updated. This mesh’s cell indexing
must correspond to <cite>rhomodel_background</cite>.</p></li>
<li><p><strong>rhomodel_background</strong> (<em>pg.RVector</em>) – Full resistivity model vector [ohm·m] for all cells
in the mesh associated with <cite>fwd_op</cite>.</p></li>
<li><p><strong>xr_active_log</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log) resistivity values
for the active region cells (marker == 2). The length of <cite>xr_active_log</cite>
must match the number of cells marked as 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response (apparent resistivities).</p></li>
<li><dl class="simple">
<dt>rhomodel_updated_pg (pg.RVector): The updated full resistivity model vector [ohm·m] after</dt><dd><p>modifying the active region.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pg.RVector]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ertforward2">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">ertforward2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_log_model_full:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforward2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ertforward2" title="Permalink to this definition"></a></dt>
<dd><p>Simplified ERT forward model calculation from a full log-transformed resistivity model.</p>
<p>Assumes <cite>xr_log_model_full</cite> is a complete vector of log-transformed (natural log)
resistivity values for all cells in the mesh already associated with <cite>fwd_op</cite>.
The function exponentiates these values, computes the response, and returns the
natural log of the response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator, with mesh and data scheme set.</p></li>
<li><p><strong>xr_log_model_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log)
resistivity values for all model cells.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em>) – This argument is present in the original signature but typically
not used if <cite>fwd_op</cite> is already configured with its mesh and
<cite>xr_log_model_full</cite> corresponds to that mesh’s cells.
If provided, it could be used for validation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log-transformed (natural log) forward response (apparent resistivities).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ertforandjac">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">ertforandjac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhomodel_linear_pg:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_active_log_full:</span> <span class="pre">~numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforandjac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ertforandjac" title="Permalink to this definition"></a></dt>
<dd><p>Forward model and Jacobian calculation for ERT, with log-transform adjustments.</p>
<p>This function computes the forward response <cite>d</cite> using <cite>rhomodel_linear_pg</cite> (which should be ρ).
It then calculates the Jacobian J_lin = ∂d/∂ρ based on <cite>rhomodel_linear_pg</cite>.
Finally, it transforms this Jacobian to J_loglog = ∂log(d)/∂log(ρ) = (ρ/d) * J_lin,
using <cite>xr_active_log_full</cite> to derive ρ for scaling (ρ = exp(xr_active_log_full)).
The response <cite>d</cite> is also returned as log(d).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.</p></li>
<li><p><strong>rhomodel_linear_pg</strong> (<em>pg.RVector</em>) – Full resistivity model vector in linear scale [ohm·m].
This is ρ, used to compute response and base Jacobian.</p></li>
<li><p><strong>xr_active_log_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log) resistivity values
for ALL model cells. This is log(ρ). Used for Jacobian scaling.
Length must match number of cells in <cite>fwd_op</cite>’s mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response, log(d).</p></li>
<li><p>J_loglog (np.ndarray): Adjusted Jacobian matrix for log-data versus log-model changes.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ertforandjac2">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">ertforandjac2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_log_model_full:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforandjac2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ertforandjac2" title="Permalink to this definition"></a></dt>
<dd><p>Alternative ERT forward model and Jacobian calculation using log-resistivity values.</p>
<p>This function is very similar to <cite>ertforandjac</cite>. It assumes the input <cite>xr_log_model_full</cite>
is the natural log of resistivity for all cells. It calculates d = f(exp(log_ρ))
and then transforms the Jacobian to J_loglog = (ρ/d) * (∂d/∂ρ).</p>
<p>The main difference from <cite>ertforandjac</cite> seems to be how the linear model <cite>rhomodel</cite>
is derived (from <cite>xr_log_model_full</cite> directly) rather than being passed in.
The Jacobian transformation logic is intended to be the same (for log-data vs log-model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.</p></li>
<li><p><strong>xr_log_model_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log)
resistivity values for all model cells.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em>) – PyGIMLi mesh. Unused in the original logic if <cite>xr_log_model_full</cite>
is for the full model set in <cite>fwd_op</cite>. Retained for signature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response.</p></li>
<li><p>J_loglog (np.ndarray): Adjusted Jacobian matrix for log-log space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.</span></span><span class="sig-name descname"><span class="pre">SeismicForwardModeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Seismic Refraction Tomography (SRT) forward modeling using PyGIMLi.</p>
<p>This class wraps PyGIMLi’s <cite>TravelTimeManager</cite> and its associated forward operator
to compute synthetic travel times based on a given velocity (or slowness) model
and measurement scheme. It also provides a method to generate synthetic datasets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the SeismicForwardModeling class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object representing the subsurface model domain.
The mesh should be suitable for seismic travel time calculation.</p></li>
<li><p><strong>scheme</strong> (<em>Optional</em><em>[</em><em>pg.DataContainer</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi DataContainer object defining the seismic survey scheme
(shot and receiver positions). If provided, it’s set on the
TravelTimeManager. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.set_scheme">
<span class="sig-name descname"><span class="pre">set_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.set_scheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.set_scheme" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the seismic data scheme for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scheme</strong> (<em>pg.DataContainer</em>) – The PyGIMLi DataContainer defining the seismic
shot and receiver configurations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.set_mesh">
<span class="sig-name descname"><span class="pre">set_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.set_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.set_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the PyGIMLi mesh for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> (<em>pg.Mesh</em>) – The PyGIMLi mesh object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_slowness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward seismic response (travel times) for a given model.</p>
<p>The model can be provided as either velocity [m/s] or slowness [s/m].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_values</strong> (<em>np.ndarray</em>) – A 1D NumPy array representing the seismic property
(slowness or velocity) for each cell in the mesh.</p></li>
<li><p><strong>is_slowness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>model_values</cite> are interpreted as slowness [s/m].
If False, <cite>model_values</cite> are interpreted as velocity [m/s]
and will be converted to slowness (1/velocity).
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A NumPy array of the computed travel times [s] for the</dt><dd><p>shot-receiver pairs defined in the scheme.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If the data scheme is not set on the manager.</p></li>
<li><p><strong>ValueError</strong> – If <cite>model_values</cite> contains non-positive velocities when <cite>is_slowness</cite> is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.create_synthetic_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensor_x_coords:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_topography_points:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_model_values:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_is_slowness:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shot_spacing:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_relative_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_absolute_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_data_path:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_travel_time_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_simulation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed_value:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x_boundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y_boundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">50.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.create_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.create_synthetic_data" title="Permalink to this definition"></a></dt>
<dd><p>Create synthetic seismic refraction tomography (SRT) data.</p>
<p>This class method simulates an SRT survey by:
1. Defining geophone positions (potentially on a given surface topography).
2. Creating a measurement scheme with shots at specified intervals.
3. Generating or using a provided mesh for the forward calculation.
4. Assigning velocity/slowness values to the mesh cells.
5. Computing synthetic travel times using the SRT forward operator.
6. Optionally adding Gaussian noise to the synthetic travel times.
7. Optionally saving the data and displaying a plot of the first arrivals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensor_x_coords</strong> (<em>np.ndarray</em>) – 1D NumPy array of X-coordinates for geophone locations [m].</p></li>
<li><p><strong>surface_topography_points</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – 2D NumPy array of [x, z] coordinates defining the surface topography.
If provided, geophone Z-coordinates will be interpolated from this surface.
If None, geophones are placed on a flat surface (Z=0). Defaults to None.</p></li>
<li><p><strong>fwd_mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh for forward modeling.
If None, a simple 2D mesh is created. Defaults to None.</p></li>
<li><p><strong>velocity_model_values</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Seismic property values for each cell of <cite>fwd_mesh</cite>.
Interpreted as velocity [m/s] or slowness [s/m] based on <cite>model_is_slowness</cite>.
If None, a default velocity model (increasing with depth) is used. Defaults to None.</p></li>
<li><p><strong>model_is_slowness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>velocity_model_values</cite> are slowness [s/m].
If False, they are velocity [m/s]. Defaults to False.</p></li>
<li><p><strong>shot_spacing</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance between shot points along the geophone line [m].
Defaults to 5.0.</p></li>
<li><p><strong>noise_relative_level</strong> (<em>float</em><em>, </em><em>optional</em>) – Relative level of Gaussian noise to add to travel times
(e.g., 0.05 for 5%). Defaults to 0.05.</p></li>
<li><p><strong>noise_absolute_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute level of Gaussian noise to add to travel times [s].
Defaults to 1e-5 s (0.01 ms).</p></li>
<li><p><strong>save_data_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – File path to save the generated synthetic data.
If None, data is not saved. Defaults to None.</p></li>
<li><p><strong>show_travel_time_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays a plot of the first arrival picks.
Defaults to False.</p></li>
<li><p><strong>verbose_simulation</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, PyGIMLi’s TravelTimeManager may print progress.
Defaults to False.</p></li>
<li><p><strong>random_seed_value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Seed for random number generator for reproducible noise.
If None, noise varies. Defaults to None.</p></li>
<li><p><strong>mesh_x_boundary_ext</strong> (<em>float</em><em>, </em><em>optional</em>) – Horizontal boundary extension for auto-generated mesh [m].
Defaults to 50.0.</p></li>
<li><p><strong>mesh_y_boundary_ext</strong> (<em>float</em><em>, </em><em>optional</em>) – Vertical boundary extension for auto-generated mesh [m].
Defaults to 50.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>synth_srt_data (pg.DataContainer): Generated synthetic SRT data with travel times and error estimates.</p></li>
<li><p>simulation_mesh (pg.Mesh): The PyGIMLi mesh used for the simulation.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pg.DataContainer, pg.Mesh]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – For invalid inputs (e.g., empty sensor_x_coords, model/mesh dimension mismatch).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.SeismicForwardModeling.draw_first_picks">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_first_picks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax:</span> <span class="pre">~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">travel_times:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_app_velocity:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.draw_first_picks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.SeismicForwardModeling.draw_first_picks" title="Permalink to this definition"></a></dt>
<dd><p>Plot first arrival travel times (or apparent velocities) for seismic refraction data.</p>
<p>This function visualizes travel time curves for each shot point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib Axes object to plot on.</p></li>
<li><p><strong>data</strong> (<em>pg.DataContainer</em>) – PyGIMLi DataContainer containing the seismic survey layout
(sensor positions ‘x’, ‘z’; shot ‘s’; geophone ‘g’ indices).
It should also contain travel times ‘t’ if <cite>travel_times</cite> is None.</p></li>
<li><p><strong>travel_times</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Array of travel times [s] to plot. If None, uses ‘t’ from <cite>data</cite>. Defaults to None.</p></li>
<li><p><strong>plot_app_velocity</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plots apparent velocity (distance/travel_time)
instead of travel times. Defaults to False.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>ax.plot()</cite>
for customizing line appearance (e.g., color, linestyle).
Default style is black dashed lines.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified matplotlib Axes object with the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-PyHydroGeophysX.forward.ert_forward">
<span id="pyhydrogeophysx-forward-ert-forward-module"></span><h2>PyHydroGeophysX.forward.ert_forward module<a class="headerlink" href="#module-PyHydroGeophysX.forward.ert_forward" title="Permalink to this heading"></a></h2>
<p>Forward modeling utilities for Electrical Resistivity Tomography (ERT) using PyGIMLi.</p>
<p>This module provides a class <cite>ERTForwardModeling</cite> to encapsulate ERT forward
modeling operations, including Jacobian calculation and synthetic data generation.
It also contains several standalone functions for forward modeling and Jacobian
computation, which might be older or specialized versions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.ert_forward.</span></span><span class="sig-name descname"><span class="pre">ERTForwardModeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform ERT forward modeling using PyGIMLi.</p>
<p>This class wraps PyGIMLi’s <cite>ert.ERTModelling</cite> operator, providing methods
to compute synthetic ERT data (apparent resistivities), calculate Jacobian matrices,
and estimate data coverage (resolution). It handles log transformations
for models and data if specified.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the ERTForwardModeling class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object representing the subsurface model domain.
The mesh should be suitable for ERT simulation (e.g., 2D or 3D).</p></li>
<li><p><strong>data_scheme</strong> (<em>Optional</em><em>[</em><em>pg.DataContainer</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi DataContainer object defining the ERT measurement scheme
(electrode configurations, etc.). If provided, it’s set on the
forward operator. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.set_data" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the ERT data scheme for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_scheme</strong> (<em>pg.DataContainer</em>) – The PyGIMLi DataContainer defining
the measurement configurations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.set_mesh">
<span class="sig-name descname"><span class="pre">set_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.set_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.set_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the PyGIMLi mesh for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> (<em>pg.Mesh</em>) – The PyGIMLi mesh object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_response:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward ERT response (apparent resistivities) for a given resistivity model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – The resistivity model values for each cell in the mesh [ohm·m].
Can be a NumPy array or a PyGIMLi RVector.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>resistivity_model</cite> is assumed to be log10-resistivity or
ln-resistivity. The method will exponentiate it (base e for ln)
before using it in the forward calculation. Defaults to True.
(Note: Original code uses <cite>np.exp</cite>, implying natural log for model).</p></li>
<li><p><strong>log_transform_response</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the computed apparent resistivities will be log-transformed (natural log)
before being returned. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A NumPy array of the computed forward response values</dt><dd><p>(apparent resistivities). Log-transformed if specified.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the forward operator fails (e.g., if data scheme not set).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.forward_and_jacobian">
<span class="sig-name descname"><span class="pre">forward_and_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_response:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.forward_and_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.forward_and_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward ERT response and the Jacobian matrix.</p>
<p>The Jacobian J_ij = ∂d_i / ∂m_j, where d_i is the i-th data point and
m_j is the j-th model parameter (cell resistivity).
If log transformations are used, the Jacobian is adjusted accordingly:
- If model is log(m) and data is log(d): J_log = (∂log(d) / ∂log(m)) = (m/d) * (∂d/∂m)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – Resistivity model values [ohm·m] or log-resistivity.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, input model is log-transformed (natural log).
Defaults to True.</p></li>
<li><p><strong>log_transform_response</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returned response and Jacobian
are for log-transformed data. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>response (np.ndarray): Forward response (apparent resistivities), potentially log-transformed.</p></li>
<li><dl class="simple">
<dt>jacobian_matrix (np.ndarray): The Jacobian matrix, adjusted for log transforms if specified.</dt><dd><p>Shape (n_data, n_model_cells).</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If data scheme not set or Jacobian creation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.get_coverage">
<span class="sig-name descname"><span class="pre">get_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resistivity_model:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform_model:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.get_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.get_coverage" title="Permalink to this definition"></a></dt>
<dd><p>Compute data coverage (approximate resolution or sensitivity density) for the mesh cells.</p>
<p>This uses PyGIMLi’s <cite>coverageDCtrans</cite> which typically computes the diagonal
of J^T * diag(1/d^2) * J, often related to sensitivity or resolution matrix diagonal.
The result is then weighted by cell sizes and log10 transformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resistivity_model</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em>) – Resistivity model values [ohm·m] or log-resistivity.</p></li>
<li><p><strong>log_transform_model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, input model is log-transformed (natural log).
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of log10-transformed coverage values for each cell in the parameter domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If data scheme not set or Jacobian/response calculation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.create_synthetic_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xpos_electrodes:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypos_electrodes:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resistivity_values:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'wa'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level_relative:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_abs_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_error_for_estimation:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x_bound:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y_bound:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">100.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ERTForwardModeling.create_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ERTForwardModeling.create_synthetic_data" title="Permalink to this definition"></a></dt>
<dd><p>Create synthetic ERT data using forward modeling.</p>
<p>This class method simulates an ERT survey by:
1. Defining electrode positions.
2. Creating a measurement scheme (e.g., Wenner, Dipole-Dipole).
3. Generating or using a provided mesh for the forward calculation.
4. Assigning resistivity values to the mesh cells.
5. Computing synthetic apparent resistivities using the ERT forward operator.
6. Optionally adding Gaussian noise to the synthetic data.
7. Optionally saving the data and displaying a pseudosection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpos_electrodes</strong> (<em>np.ndarray</em>) – 1D NumPy array of X-coordinates for electrodes [m].</p></li>
<li><p><strong>ypos_electrodes</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – 1D NumPy array of Y-coordinates (depth/elevation)
for electrodes [m]. If None, assumes a flat
surface (all Y=0). Defaults to None.</p></li>
<li><p><strong>fwd_mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh to use for forward modeling.
If None, a simple rectangular mesh is created based on
electrode positions. Defaults to None.</p></li>
<li><p><strong>resistivity_values</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pg.Vector</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Resistivity values [ohm·m] for each cell of the <cite>fwd_mesh</cite>.
If None, a default homogeneous resistivity (100 ohm·m) is used.
Must match the number of cells in <cite>fwd_mesh</cite>. Defaults to None.</p></li>
<li><p><strong>scheme_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the ERT array configuration to use (e.g., ‘wa’ for Wenner alpha,
‘dd’ for dipole-dipole, ‘schlumberger’, ‘gr’ for gradient).
Passed to <cite>ert.createData</cite>. Defaults to ‘wa’.</p></li>
<li><p><strong>noise_level_relative</strong> (<em>float</em><em>, </em><em>optional</em>) – Relative level of Gaussian noise to add to the
synthetic data (e.g., 0.05 for 5% noise).
Noise is calculated as <cite>data * (1 + N(0,1)*noise_level_relative)</cite>.
Defaults to 0.05.</p></li>
<li><p><strong>noise_abs_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute error component used for error estimation
by <cite>ert.ERTManager().estimateError()</cite>. Typically in units of the
measured quantity if that were voltage (e.g., uV), or ohm-m if data is already rhoa.
Defaults to 0.0.</p></li>
<li><p><strong>relative_error_for_estimation</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Relative error percentage for
<cite>ert.ERTManager().estimateError()</cite>.
If None, <cite>noise_level_relative</cite> is used. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – File path to save the generated synthetic data
(e.g., ‘synthetic_data.dat’). If None, data is not saved.
Defaults to None.</p></li>
<li><p><strong>show_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays a pseudosection of the generated data.
Defaults to False.</p></li>
<li><p><strong>random_seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Seed for the random number generator to ensure
reproducible noise. If None, noise will vary.
Defaults to None.</p></li>
<li><p><strong>mesh_x_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Horizontal boundary extension factor/distance if a new mesh
is created. Used by <cite>pg.meshtools.appendTriangleBoundary</cite>.
Defaults to 100.0.</p></li>
<li><p><strong>mesh_y_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Vertical boundary extension factor/distance if a new mesh
is created. Defaults to 100.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>synth_data (pg.DataContainer): The generated synthetic ERT data with ‘rhoa’ and ‘err’ fields.</p></li>
<li><p>simulation_mesh (pg.Mesh): The PyGIMLi mesh used for the forward simulation.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pg.DataContainer, pg.Mesh]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <cite>xpos_electrodes</cite> is empty or if <cite>ypos_electrodes</cite> (if provided)
    does not match <cite>xpos_electrodes</cite> length, or if resistivity_values
    length doesn’t match mesh cell count.</p></li>
<li><p><strong>TypeError</strong> – If inputs are of incorrect type.</p></li>
<li><p><strong>RuntimeError</strong> – If PyGIMLi scheme creation or forward modeling fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ertforward">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.ert_forward.</span></span><span class="sig-name descname"><span class="pre">ertforward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_with_markers:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhomodel_background:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_active_log:</span> <span class="pre">~numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Vector'</span> <span class="pre">id='2068140016080'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ertforward" title="Permalink to this definition"></a></dt>
<dd><p>Performs ERT forward modeling, updating only a specific region of the model.</p>
<p>This function takes an existing background resistivity model (<cite>rhomodel_background</cite>),
updates a portion of it (where cell markers == 2 in <cite>mesh_with_markers</cite>)
with new log-transformed resistivity values (<cite>xr_active_log</cite>), and then computes
the forward response. The response is returned as log-transformed apparent resistivities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.
Must have data scheme and full forward mesh already set.
The full forward mesh should be consistent with <cite>rhomodel_background</cite>.</p></li>
<li><p><strong>mesh_with_markers</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object whose cell markers define the active region.
Cells with marker 2 will be updated. This mesh’s cell indexing
must correspond to <cite>rhomodel_background</cite>.</p></li>
<li><p><strong>rhomodel_background</strong> (<em>pg.RVector</em>) – Full resistivity model vector [ohm·m] for all cells
in the mesh associated with <cite>fwd_op</cite>.</p></li>
<li><p><strong>xr_active_log</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log) resistivity values
for the active region cells (marker == 2). The length of <cite>xr_active_log</cite>
must match the number of cells marked as 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response (apparent resistivities).</p></li>
<li><dl class="simple">
<dt>rhomodel_updated_pg (pg.RVector): The updated full resistivity model vector [ohm·m] after</dt><dd><p>modifying the active region.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pg.RVector]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ertforward2">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.ert_forward.</span></span><span class="sig-name descname"><span class="pre">ertforward2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_log_model_full:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforward2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ertforward2" title="Permalink to this definition"></a></dt>
<dd><p>Simplified ERT forward model calculation from a full log-transformed resistivity model.</p>
<p>Assumes <cite>xr_log_model_full</cite> is a complete vector of log-transformed (natural log)
resistivity values for all cells in the mesh already associated with <cite>fwd_op</cite>.
The function exponentiates these values, computes the response, and returns the
natural log of the response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator, with mesh and data scheme set.</p></li>
<li><p><strong>xr_log_model_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log)
resistivity values for all model cells.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em>) – This argument is present in the original signature but typically
not used if <cite>fwd_op</cite> is already configured with its mesh and
<cite>xr_log_model_full</cite> corresponds to that mesh’s cells.
If provided, it could be used for validation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log-transformed (natural log) forward response (apparent resistivities).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ertforandjac">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.ert_forward.</span></span><span class="sig-name descname"><span class="pre">ertforandjac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhomodel_linear_pg:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Vector'</span> <span class="pre">id='2068140016080'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_active_log_full:</span> <span class="pre">~numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforandjac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ertforandjac" title="Permalink to this definition"></a></dt>
<dd><p>Forward model and Jacobian calculation for ERT, with log-transform adjustments.</p>
<p>This function computes the forward response <cite>d</cite> using <cite>rhomodel_linear_pg</cite> (which should be ρ).
It then calculates the Jacobian J_lin = ∂d/∂ρ based on <cite>rhomodel_linear_pg</cite>.
Finally, it transforms this Jacobian to J_loglog = ∂log(d)/∂log(ρ) = (ρ/d) * J_lin,
using <cite>xr_active_log_full</cite> to derive ρ for scaling (ρ = exp(xr_active_log_full)).
The response <cite>d</cite> is also returned as log(d).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.</p></li>
<li><p><strong>rhomodel_linear_pg</strong> (<em>pg.RVector</em>) – Full resistivity model vector in linear scale [ohm·m].
This is ρ, used to compute response and base Jacobian.</p></li>
<li><p><strong>xr_active_log_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log) resistivity values
for ALL model cells. This is log(ρ). Used for Jacobian scaling.
Length must match number of cells in <cite>fwd_op</cite>’s mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response, log(d).</p></li>
<li><p>J_loglog (np.ndarray): Adjusted Jacobian matrix for log-data versus log-model changes.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.ert_forward.ertforandjac2">
<span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.ert_forward.</span></span><span class="sig-name descname"><span class="pre">ertforandjac2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwd_op:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.ert.ERTModelling'</span> <span class="pre">id='2068140102032'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xr_log_model_full:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/ert_forward.html#ertforandjac2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.ert_forward.ertforandjac2" title="Permalink to this definition"></a></dt>
<dd><p>Alternative ERT forward model and Jacobian calculation using log-resistivity values.</p>
<p>This function is very similar to <cite>ertforandjac</cite>. It assumes the input <cite>xr_log_model_full</cite>
is the natural log of resistivity for all cells. It calculates d = f(exp(log_ρ))
and then transforms the Jacobian to J_loglog = (ρ/d) * (∂d/∂ρ).</p>
<p>The main difference from <cite>ertforandjac</cite> seems to be how the linear model <cite>rhomodel</cite>
is derived (from <cite>xr_log_model_full</cite> directly) rather than being passed in.
The Jacobian transformation logic is intended to be the same (for log-data vs log-model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fwd_op</strong> (<em>ert.ERTModelling</em>) – Initialized PyGIMLi ERTModelling operator.</p></li>
<li><p><strong>xr_log_model_full</strong> (<em>np.ndarray</em>) – 1D NumPy array of log-transformed (natural log)
resistivity values for all model cells.</p></li>
<li><p><strong>mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em>) – PyGIMLi mesh. Unused in the original logic if <cite>xr_log_model_full</cite>
is for the full model set in <cite>fwd_op</cite>. Retained for signature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dr_log (np.ndarray): Log-transformed (natural log) forward response.</p></li>
<li><p>J_loglog (np.ndarray): Adjusted Jacobian matrix for log-log space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-PyHydroGeophysX.forward.srt_forward">
<span id="pyhydrogeophysx-forward-srt-forward-module"></span><h2>PyHydroGeophysX.forward.srt_forward module<a class="headerlink" href="#module-PyHydroGeophysX.forward.srt_forward" title="Permalink to this heading"></a></h2>
<p>Forward modeling utilities for Seismic Refraction Tomography (SRT) using PyGIMLi.</p>
<p>This module provides a class <cite>SeismicForwardModeling</cite> to encapsulate SRT forward
modeling operations, primarily focused on travel time calculations. It includes
functionality for generating synthetic seismic refraction data and a helper
function for plotting first arrival travel times.</p>
<dl class="py class">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PyHydroGeophysX.forward.srt_forward.</span></span><span class="sig-name descname"><span class="pre">SeismicForwardModeling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Seismic Refraction Tomography (SRT) forward modeling using PyGIMLi.</p>
<p>This class wraps PyGIMLi’s <cite>TravelTimeManager</cite> and its associated forward operator
to compute synthetic travel times based on a given velocity (or slowness) model
and measurement scheme. It also provides a method to generate synthetic datasets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the SeismicForwardModeling class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<em>pg.Mesh</em>) – A PyGIMLi mesh object representing the subsurface model domain.
The mesh should be suitable for seismic travel time calculation.</p></li>
<li><p><strong>scheme</strong> (<em>Optional</em><em>[</em><em>pg.DataContainer</em><em>]</em><em>, </em><em>optional</em>) – A PyGIMLi DataContainer object defining the seismic survey scheme
(shot and receiver positions). If provided, it’s set on the
TravelTimeManager. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.set_scheme">
<span class="sig-name descname"><span class="pre">set_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheme:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.set_scheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.set_scheme" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the seismic data scheme for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scheme</strong> (<em>pg.DataContainer</em>) – The PyGIMLi DataContainer defining the seismic
shot and receiver configurations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.set_mesh">
<span class="sig-name descname"><span class="pre">set_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.set_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.set_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Set or update the PyGIMLi mesh for forward modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> (<em>pg.Mesh</em>) – The PyGIMLi mesh object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_slowness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the forward seismic response (travel times) for a given model.</p>
<p>The model can be provided as either velocity [m/s] or slowness [s/m].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_values</strong> (<em>np.ndarray</em>) – A 1D NumPy array representing the seismic property
(slowness or velocity) for each cell in the mesh.</p></li>
<li><p><strong>is_slowness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>model_values</cite> are interpreted as slowness [s/m].
If False, <cite>model_values</cite> are interpreted as velocity [m/s]
and will be converted to slowness (1/velocity).
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A NumPy array of the computed travel times [s] for the</dt><dd><p>shot-receiver pairs defined in the scheme.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If the data scheme is not set on the manager.</p></li>
<li><p><strong>ValueError</strong> – If <cite>model_values</cite> contains non-positive velocities when <cite>is_slowness</cite> is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.create_synthetic_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensor_x_coords:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_topography_points:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_mesh:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.Mesh'</span> <span class="pre">id='2068138335696'&gt;</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_model_values:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_is_slowness:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shot_spacing:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_relative_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_absolute_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_data_path:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_travel_time_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_simulation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed_value:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_x_boundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_y_boundary_ext:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">50.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mesh'</span> <span class="pre">id='2068138335696'&gt;]</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.create_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.create_synthetic_data" title="Permalink to this definition"></a></dt>
<dd><p>Create synthetic seismic refraction tomography (SRT) data.</p>
<p>This class method simulates an SRT survey by:
1. Defining geophone positions (potentially on a given surface topography).
2. Creating a measurement scheme with shots at specified intervals.
3. Generating or using a provided mesh for the forward calculation.
4. Assigning velocity/slowness values to the mesh cells.
5. Computing synthetic travel times using the SRT forward operator.
6. Optionally adding Gaussian noise to the synthetic travel times.
7. Optionally saving the data and displaying a plot of the first arrivals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensor_x_coords</strong> (<em>np.ndarray</em>) – 1D NumPy array of X-coordinates for geophone locations [m].</p></li>
<li><p><strong>surface_topography_points</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – 2D NumPy array of [x, z] coordinates defining the surface topography.
If provided, geophone Z-coordinates will be interpolated from this surface.
If None, geophones are placed on a flat surface (Z=0). Defaults to None.</p></li>
<li><p><strong>fwd_mesh</strong> (<em>Optional</em><em>[</em><em>pg.Mesh</em><em>]</em><em>, </em><em>optional</em>) – A pre-defined PyGIMLi mesh for forward modeling.
If None, a simple 2D mesh is created. Defaults to None.</p></li>
<li><p><strong>velocity_model_values</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Seismic property values for each cell of <cite>fwd_mesh</cite>.
Interpreted as velocity [m/s] or slowness [s/m] based on <cite>model_is_slowness</cite>.
If None, a default velocity model (increasing with depth) is used. Defaults to None.</p></li>
<li><p><strong>model_is_slowness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>velocity_model_values</cite> are slowness [s/m].
If False, they are velocity [m/s]. Defaults to False.</p></li>
<li><p><strong>shot_spacing</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance between shot points along the geophone line [m].
Defaults to 5.0.</p></li>
<li><p><strong>noise_relative_level</strong> (<em>float</em><em>, </em><em>optional</em>) – Relative level of Gaussian noise to add to travel times
(e.g., 0.05 for 5%). Defaults to 0.05.</p></li>
<li><p><strong>noise_absolute_val</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute level of Gaussian noise to add to travel times [s].
Defaults to 1e-5 s (0.01 ms).</p></li>
<li><p><strong>save_data_path</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – File path to save the generated synthetic data.
If None, data is not saved. Defaults to None.</p></li>
<li><p><strong>show_travel_time_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays a plot of the first arrival picks.
Defaults to False.</p></li>
<li><p><strong>verbose_simulation</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, PyGIMLi’s TravelTimeManager may print progress.
Defaults to False.</p></li>
<li><p><strong>random_seed_value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Seed for random number generator for reproducible noise.
If None, noise varies. Defaults to None.</p></li>
<li><p><strong>mesh_x_boundary_ext</strong> (<em>float</em><em>, </em><em>optional</em>) – Horizontal boundary extension for auto-generated mesh [m].
Defaults to 50.0.</p></li>
<li><p><strong>mesh_y_boundary_ext</strong> (<em>float</em><em>, </em><em>optional</em>) – Vertical boundary extension for auto-generated mesh [m].
Defaults to 50.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>synth_srt_data (pg.DataContainer): Generated synthetic SRT data with travel times and error estimates.</p></li>
<li><p>simulation_mesh (pg.Mesh): The PyGIMLi mesh used for the simulation.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pg.DataContainer, pg.Mesh]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – For invalid inputs (e.g., empty sensor_x_coords, model/mesh dimension mismatch).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.draw_first_picks">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_first_picks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax:</span> <span class="pre">~typing.Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">&lt;MagicMock</span> <span class="pre">name='mock.DataContainer'</span> <span class="pre">id='2068139737616'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">travel_times:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_app_velocity:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs:</span> <span class="pre">~typing.Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/PyHydroGeophysX/forward/srt_forward.html#SeismicForwardModeling.draw_first_picks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PyHydroGeophysX.forward.srt_forward.SeismicForwardModeling.draw_first_picks" title="Permalink to this definition"></a></dt>
<dd><p>Plot first arrival travel times (or apparent velocities) for seismic refraction data.</p>
<p>This function visualizes travel time curves for each shot point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib Axes object to plot on.</p></li>
<li><p><strong>data</strong> (<em>pg.DataContainer</em>) – PyGIMLi DataContainer containing the seismic survey layout
(sensor positions ‘x’, ‘z’; shot ‘s’; geophone ‘g’ indices).
It should also contain travel times ‘t’ if <cite>travel_times</cite> is None.</p></li>
<li><p><strong>travel_times</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Array of travel times [s] to plot. If None, uses ‘t’ from <cite>data</cite>. Defaults to None.</p></li>
<li><p><strong>plot_app_velocity</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plots apparent velocity (distance/travel_time)
instead of travel times. Defaults to False.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments passed directly to <cite>ax.plot()</cite>
for customizing line appearance (e.g., color, linestyle).
Default style is black dashed lines.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified matplotlib Axes object with the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="petrophysics.html" class="btn btn-neutral float-left" title="PyHydroGeophysX.petrophysics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inversion.html" class="btn btn-neutral float-right" title="PyHydroGeophysX.inversion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hang Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>